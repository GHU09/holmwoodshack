function replaceQueryParam(n,t,i){var u=new RegExp("([?;&])"+n+"[^&;]*[;&]?"),r=i.replace(u,"$1").replace(/&$/,"");return(r.length>2?r+"&":"?")+(t?n+"="+t:"")}function randomInteger(n,t){return n=Math.ceil(n),t=Math.floor(t),Math.floor(Math.random()*(t-n+1))+n}function openLanguageForm(){var n=createOverlay("");n.load("/Common/Language",function(){});n.overlay({partialViewModel:!0,removeContent:!0,close:function(){}})}function openContactForm(){var n=createOverlay("",[{key:"data-html2canvas-ignore",value:""}]);n.load("/About/ContactForm",function(){});n.overlay({partialViewModel:!0,removeContent:!0,close:function(){}})}function openManageForm(){var n=createOverlay("");n.load("/Account/ManageForm",function(){});n.overlay({partialViewModel:!0,removeContent:!0,close:function(){location.reload()}})}function startPageTour(){viewModel&&viewModel.startTour&&viewModel.startTour()}function formatDate(n){var t=null,i;return n!==null&&(i=new Date(n),t=$.datepicker.formatDate("yy-mm-dd",i)),t}function formatTime(n){var t=Math.floor(n/60),i=Math.floor(n-t*60);return t<10&&(t="0"+t),i<10&&(i="0"+i),t+":"+i}function createOverlay(n,t){var i=$('<div class="overlay '+n+' no-padding" />');return t&&t.forEach(function(n){i.attr(n.key,n.value)}),i.append('<div class="align-center loader"><img src="/Images/preloader.gif" alt="Loading..." /><\/div>'),$("body").append(i),i}function getScoreColor(n){return n==="Low"?housestyle.red:n==="Medium"?housestyle.orange:n==="High"?housestyle.green:void 0}function CommonViewModel(n){var t=this;t.vm=n;t.messages=ko.observable();t.init=function(){$.get("/api/messages/unread",function(n){t.messages(n);var i=document.getElementById("message-count");i&&(i.innerText=n,document.getElementById("message-count-container").classList.remove("hidden"))})}}function PromptLanguageViewModel(){$(document).on("click",".overlay [data-language-id]",function(){$(this).addClass("active");$(".overlay .status").show();var n=$(this).data("language-id");$.ajax({data:{LanguageId:n},dataType:"json",type:"POST",url:"/api/Language/Set"}).done(function(){window.location.reload(!0)}).fail(function(n){holmwoods.showNotification(n.responseJSON.Message,!0);$(".overlay .status").hide()})});setTimeout(function(){$(".language-prompt").overlay()},750)}function QuickstartPopupViewModel(n){var t=$(".quickstart-popup");$(document.body).on("click.quickstart",function(n){t.is(n.target)||t.has(n.target).length!==0||(t.overlay("close"),$(document.body).off("click.quickstart"))});setTimeout(function(){t.overlay({close:function(){n&&viewModel&&viewModel.startTour&&setTimeout(viewModel.startTour,1e3)}})},750)}function LoginViewModel(){var n=this;$('.login-first input[type="text"]:first').focus();$("form").submit(function(){$(this).valid()?$(this).find("input[type=submit]").prop("disabled",!0):$(this).find("input[type=submit]").prop("disabled",!1)});window.localStorage&&window.localStorage.removeItem("logged_in")}function ToegangOrgSignUpViewModel(){var n=this;n.code=ko.observable("");n.codeVerified=ko.observable(null);n.saving=ko.observable(!1);n.school=ko.observable();n.class=ko.observable();n.verify=function(){n.code()&&$.get("/api/sign-up/student/start/"+n.code().trim(),function(t){t?(n.codeVerified(!0),n.school(t.CustomerName),n.class(t.ClassName)):n.codeVerified(!1)}).fail(function(){n.codeVerified(!1)})};$("form").submit(function(){n.saving(!0)})}function languagePopupViewModel(){var n=this;n.select=function(n){$.post("/api/Language/Set",{LanguageId:n},function(){window.location.reload()})};n.cancel=function(){$(".overlay").overlay("close")}}function contactViewModel(n,t,i,r){var u=this;u.showEmailForm=ko.observable(!r);u.showEmailButton=ko.observable(i);u.messages=ko.observableArray([]);u.question=ko.observable("");u.sessionId="";u.count=0;u.send=function(){if(u.question().length!==0){var n=u.question();u.question("");u.messages.push({text:n,isUser:!0});$.post("/api/about/supportchat",{session:u.sessionId,message:n},function(n){u.sessionId=n.SessionId;n.Text.forEach(function(n){u.messages.push({text:n,isUser:!1})});u.count++>1&&u.showEmailButton(!0);u.scroll()}).fail(function(){u.showEmailButton(!0)});u.scroll()}};u.keyPressed=function(n,t){return t.keyCode===13?(u.send(),!1):!0};u.scroll=function(){var n=document.getElementById("messages");n.scrollTop=n.scrollHeight};u.sendEmail=function(){u.showEmailButton()&&u.showEmailForm(!0)};u.saving=ko.observable(!1);u.target="about/contactform";u.sender=ko.observable(n);u.email=ko.observable(t);u.subject=ko.observable();u.message=ko.observable();u.submit=function(){u.saving(!0);var i={Sender:u.sender(),Email:u.email(),Subject:u.subject(),Message:u.message(),Url:document.URL},r=$(document).scrollTop(),n=$(window).height(),t=$(document).width();html2canvas(document.body,{useCORS:!0,onrendered:function(f){var e=$('<canvas id="feedback-canvas-tmp" width="'+t+'" height="'+n+'"/>').hide().appendTo("body"),s=e.get(0).getContext("2d"),o;s.drawImage(f,0,r,t,n,0,0,t,n);o=e.get(0).toDataURL();i.Screenshot=o;$.ajax({data:i,type:"POST",url:"/api/"+u.target}).done(function(){$(".overlay").overlay("close")}).fail(function(n){holmwoods.showNotification(n.responseJSON.Message,!0)}).always(function(){u.saving(!1)})},proxy:undefined,letterRendering:!1})};u.cancel=function(){$(".overlay").overlay("close")};$.getScript("/Scripts/html2canvas.js");$.getScript("/Scripts/canvg.js");$.getScript("/Scripts/rgbcolor.js")}function manageAccountViewModel(n,t){var i=this;i.saving=ko.observable(!1);i.gender=ko.observable(t.gender);i.firstName=ko.observable(t.firstName);i.middleName=ko.observable(t.middleName);i.lastName=ko.observable(t.lastName);i.email=ko.observable(n);i.password=ko.observable();i.newPassword=ko.observable();i.confirmPassword=ko.observable();i.newsletter=ko.observable(t.newsletter);i.twoFactor=ko.observable(t.twoFactor);i.setUpTwoFactor=function(){var n=createOverlay("",[{key:"data-id",value:"set-up-two-factor"}]);n.load("/Account/SetUpTwoFactor",function(){});n.overlay({partialViewModel:!0,removeContent:!0,secondaryOverlay:!0,close:function(){}})};i.deleteTwoFactor=function(){confirm("Are you sure?")&&(i.saving(!0),$.ajax({type:"DELETE",url:"/api/account/deletetwofactor"}).done(function(){i.twoFactor(null)}).fail(function(n){n.responseJSON.Message?holmwoods.showNotification(n.responseJSON.Message,!0):holmwoods.showNotification(n.responseJSON,!0)}).always(function(){i.saving(!1)}))};i.printTwoFactor=function(){$.ajax({type:"GET",url:"/api/account/TwoFactorBackupCode"}).done(function(n){var i=window.open();i.document.write(t.twoFactorPrint.replace("<span translate='no'>*|CODE|*<\/span>",n).replace("<span translate='no'>*|DATE|*<\/span>",moment().format("YYYY-MM-DD HH:mm")));i.print();i.close()}).fail(function(n){n.responseJSON.Message?holmwoods.showNotification(n.responseJSON.Message,!0):holmwoods.showNotification(n.responseJSON,!0)})};i.submit=function(){i.saving(!0);var n={gender:i.gender(),firstName:i.firstName(),middleName:i.middleName(),lastName:i.lastName(),email:i.email(),oldPassword:i.password(),newPassword:i.newPassword(),confirmPassword:i.confirmPassword(),newsletter:i.newsletter()};$.ajax({data:n,type:"POST",url:"/api/account/manage"}).done(function(){$(".overlay").overlay("close")}).fail(function(n){n.responseJSON.Message?holmwoods.showNotification(n.responseJSON.Message,!0):holmwoods.showNotification(n.responseJSON,!0)}).always(function(){i.saving(!1)})};i.deleteAccount=function(){$(".overlay").load("/Account/DeleteConfirmForm")};i.cancel=function(){$(".overlay").overlay("close")}}function deleteAccountViewModel(){var n=this;n.saving=ko.observable(!1);n.password=ko.observable();n.submit=function(){n.saving(!0);$.ajax({data:{password:n.password()},type:"DELETE",url:"/api/account/delete"}).done(function(){window.location="/"}).fail(function(n){n.responseJSON.Message?holmwoods.showNotification(n.responseJSON.Message,!0):holmwoods.showNotification(n.responseJSON,!0)}).always(function(){n.saving(!1)})};n.cancel=function(){$(".overlay").overlay("close")}}function setUpTwoFactorViewModel(n){var t=this;t.password=ko.observable("");t.qr=ko.observable(null);t.totp=ko.observable("");t.backupCode=ko.observable("");t.saving=ko.observable(!1);t.verifyPassword=function(){t.password().length!==0&&$.ajax({data:{password:t.password()},type:"POST",url:"/api/account/generateTotp"}).done(function(n){t.qr(n)}).fail(function(n){n.responseJSON.Message?holmwoods.showNotification(n.responseJSON.Message,!0):holmwoods.showNotification(n.responseJSON,!0)})};t.verify=function(){t.totp().length!==0&&(t.saving(!0),$.ajax({data:{code:t.totp(),secretKey:t.qr().SecretKey},type:"POST",url:"/api/account/addtwofactor"}).done(function(n){t.backupCode(n)}).fail(function(n){n.responseJSON.Message?holmwoods.showNotification(n.responseJSON.Message,!0):holmwoods.showNotification(n.responseJSON,!0);t.verifyPassword()}).always(function(){t.saving(!1)}))};t.printCode=function(){var i=window.open();i.document.write(n.replace("<span translate='no'>*|CODE|*<\/span>",t.backupCode()).replace("<span translate='no'>*|DATE|*<\/span>",moment().format("YYYY-MM-DD HH:mm")));i.print();i.close()};t.close=function(){$(".overlay[data-id=set-up-two-factor]").overlay("close")}}function helpViewModel(n){var t=this;t.categories=ko.observableArray(n.categories);t.query=ko.observable("").extend({rateLimit:{method:"notifyWhenChangesStop",timeout:250}});t.category=ko.observable();t.topics=ko.observableArray([]);t.topic=ko.observable();t.template=ko.observable("categories");t.init=function(){if(n.selectedCategory){var i=t.categories().find(function(t){return t.Id===n.selectedCategory});i&&t.openCategory(i)}n.selectedTopic&&t.category()&&t.openTopic(n.selectedTopic)};t.query.subscribe(function(n){n.length===0&&t.template()==="search"?(t.back(),$(".help-search input").focus()):t.search()});t.search=function(){t.query()&&$.getJSON("/api/help/search",{query:t.query()},function(n){t.topics(n);t.template("search");$(".help-search input").focus()})};t.openCategory=function(n){t.category(n);$.getJSON("/api/help/category/"+n.Id,function(n){t.topics(n)});t.template("category")};t.openTopic=function(n,i){i&&(t.template()==="search"?t.category(t.categories().find(function(n){return n.Id===i})):t.category(i));$.getJSON("/api/help/topic/"+n,function(n){t.topic(n)});t.template("topic")};t.back=function(){switch(t.template()){case"topic":t.query()?t.template("search"):t.topics().length>0?t.template("category"):(t.template("categories"),t.category(null));t.topic(null);break;case"category":t.template("categories");t.topics([]);t.category(null);break;case"search":t.query("");t.template("categories");t.category(null);t.topic(null);t.topics([]);break;case"categories":window.history.back()}};t.updateHistory=ko.computed(function(){var n="/Help";return t.category()&&(n+="/"+t.category().Url),t.topic()&&(n+="/"+t.topic().Url),window.history.replaceState(null,"",n),n}).extend({deferred:!0})}function resultsTimelineViewModel(n,t,i,r,u,f,e,o,s,h,c,l){var a=this;a.selectedSubscription=ko.observable(ko.utils.arrayFirst(i,function(n){return n.SubscriptionId===t}));a.selectedSubscriptionId=ko.pureComputed(function(){return a.selectedSubscription().SubscriptionId});a.selectedStudentId=ko.observable(r);a.essentialsViews=ko.observableArray(e);a.premiumViews=ko.observableArray(o);a.selectedView=ko.observableArray(f);a.startDate=ko.observable(formatDate(s));a.endDate=ko.observable(formatDate(h));a.selectedSkill=ko.observable(u);a.premiumTimeline=ko.observableArray([]);a.essentialsTimeline=ko.observableArray([]);a.loadingTimeline=ko.observable();a.pass=ko.observable(c);a.high=ko.observable(a.pass()*(75/55));a.pages=ko.observableArray();a.periods=ko.observableArray();a.selectedPeriod=ko.observable();a.openedResults=ko.observableArray();a.selectView=function(n){a.selectedView(n===CourseType.PREMIUM?a.premiumViews():a.essentialsViews())};a.isViewSelected=function(n){return ko.utils.arrayFirst(a.selectedView(),function(t){return t===n})};a.toggleView=function(n){a.isViewSelected(n)?a.selectedView.remove(function(t){return t===n}):a.selectedView.push(n)};a.selectedSubscription.subscribe(function(){a.selectView(a.selectedSubscription().CourseType);a.grid.hideOtherPages(a.selectedSubscription().CourseType===CourseType.PREMIUM)});a.downloadCertificate=function(n){window.open("/results/certificate/"+n.CertificateId,"_blank")};a.reviewResult=function(t){(n||t.QuestionType==="Recording"||t.QuestionType==="Writing"||t.QuestionType==="WritingEditDistance")&&LoadResultModal(t.ExerciseProgressId)};a.selectPeriod=function(){updateSelectedPeriodPreset(a.startDate,a.endDate,a.selectedPeriod)};a.selectOther=function(n){selectOtherPeriodPreset(a.periods,a.selectedPeriod,n)};a.grid=new ko.pagedDataSet({url:l,data:{subscriptionId:a.selectedSubscriptionId,userId:a.selectedStudentId,selectedView:a.selectedView,selectedSkill:a.selectedSkill,startDate:a.startDate,endDate:a.endDate},dataCallback:function(n){a.selectedSubscription().CourseType===CourseType.PREMIUM?a.premiumTimeline(n.map(n=>new resultTimelineViewModel(n,a))):a.essentialsTimeline(n.map(n=>new resultTimelineViewModel(n,a)))},pageCallback:a.pages,hideOtherPages:a.selectedSubscription().CourseType===CourseType.PREMIUM,pageSize:25,initialPage:1,loading:a.loadingTimeline,error:function(n){holmwoods.showNotification(n.responseJSON.Message,!0)}});a.openedResults.subscribe(function(n){n.forEach(function(n){n.status==="added"?n.value.showResult(!0):n.status==="deleted"&&n.value.showResult(!1)})},null,"arrayChange")}function LoadResultModal(n){var t=createOverlay("wide");t.load("/Results/Review/"+n,function(){t.find(".close-button").click(function(){t.overlay("close")});holmwoods.toLocaleDate(".overlay")});t.overlay({removeContent:!0})}function updateSelectedPeriodPreset(n,t,i){i()&&(i().Type==="Other"||i().Type===PeriodType.OTHER?$("#start-date").focus():(n(moment(i().Start).format("YYYY-MM-DD")),t(moment(i().End).format("YYYY-MM-DD"))))}function selectOtherPeriodPreset(n,t,i){var r=ko.utils.arrayFirst(n(),function(n){return n.Type===i});t(r)}function smartGoalViewModel(n,t){var i=this;i.goal=ko.observable(n.Goal);i.currentWeek=ko.observable(n.CurrentWeek);i.filter=ko.observable(t);i.selectedUser=ko.observable(n.User?n.User.UserId:"");i.minDate=ko.observable();i.maxDate=ko.observable();i.overviewChart={type:"line",showLegend:!1,maintainAspectRatio:!1,labelProperty:"Label",valueProperty:"Value",verticalGridLines:!1,highLightOnXPosition:!0,showXAxisLabels:!1,offsetXAxis:!0,showTooltipTitle:!0,getTooltipLabel:function(n,t){return t.datasets[n.datasetIndex].meta[n.index].Title},tooltipBackgroundColor:housestyle.holmwoodsBlue,tooltipPadding:12,tooltipFontFamily:housestyle.defaultFontFamily,datasets:ko.observableArray([])};i.timeChart={type:"bar",showLegend:!1,maintainAspectRatio:!1,labelProperty:"Label",valueProperty:"Value",verticalGridLines:!1,highLightOnXPosition:!0,showXAxisLabels:!1,offsetXAxis:!0,showTooltipTitle:!0,getTooltipLabel:function(n,t){return isNaN(n.yLabel)?"":t.datasets[n.datasetIndex].meta[n.index].Title+": "+formatTime(n.yLabel)},getYAxisLabel:function(n){return formatTime(n)},tooltipBackgroundColor:housestyle.holmwoodsBlue,tooltipPadding:12,tooltipFontFamily:housestyle.defaultFontFamily,datasets:ko.observableArray([])};i.loadData=function(n,t){i.selectedUser()&&$.getJSON(n,function(n){(i.goal(n.Goal),i.currentWeek(n.CurrentWeek),t(n),n.Goal!==null)&&(n.GoalProgress.length>0&&(i.minDate(n.GoalProgress[0].Label),i.maxDate(n.GoalProgress[n.GoalProgress.length-1].Label)),i.overviewChart.datasets([{data:n.GoalProgress,label:"Goal",fill:!1,color:housestyle.holmwoodsBlue,pointRadius:4,pointHoverRadius:6},{data:n.TargetProgress,label:"Target",fill:!1,color:housestyle.green,borderDash:[10,5],pointRadius:4,pointHoverRadius:6},{data:n.ActualProgress,label:"Actual",fill:!1,color:housestyle.green,pointRadius:4,pointHoverRadius:6}]),i.timeChart.datasets([{data:n.TargetTime,label:"Actual",type:"line",fill:!1,color:housestyle.holmwoodsBlue},{data:n.ActualTime,label:"Target",color:housestyle.green}]))})}}function studentOverviewViewModel(n,t,i,r,u,f,e){var o=this;o.loadingScorecard=ko.observable(!1);o.loadingOverview=ko.observable(!1);o.loadingPeriod=ko.observable(!1);o.loading=ko.pureComputed(function(){return o.loadingScorecard()||o.loadingOverview()});o.premiumProgress=ko.observable(u.PremiumProgress);o.essentialsProgress=ko.observable(u.EssentialsProgress);o.subscriptions=ko.observableArray(u.Subscriptions);o.selectedLevel=ko.observable(u.PremiumProgress===null?u.EssentialsProgress.LevelId:u.PremiumProgress.LevelId);o.selectedUnit=ko.observable(u.PremiumProgress===null?null:u.PremiumProgress.UnitId);o.periods=ko.observableArray([]);o.selectedPeriod=ko.observable();o.unitProgressShown=ko.observable(!1);o.scorecard=ko.observableArray([]);o.start=ko.observable(f);o.end=ko.observable(e);o.scoreClassification={medium:u.ScoreMediumClassification,high:u.ScoreHighClassification};o.progressChart=new studentWeeklyProgressGraphViewModel(o,t);o.showUnitProgress=function(){o.unitProgressShown(!o.unitProgressShown());o.unitProgressShown()?(o.progressChart.progressChart.showYAxis[1]=!0,o.progressChart.progressChart.datasets()[1].hide(!1)):(o.progressChart.progressChart.showYAxis[1]=!1,o.progressChart.progressChart.datasets()[1].hide(!0))};o.selectLevel=function(n){(n.Current||n.Start!==null&&n.End!==null)&&(o.selectedLevel()!==n.Id&&($.get(i.unitHistory(n),function(n){o.premiumProgress().UnitProgress=n;o.premiumProgress.valueHasMutated()}),o.selectedLevel(n.Id)),o.start(moment(n.Start).format("YYYY-MM-DD")),o.end(moment(n.End).format("YYYY-MM-DD")))};o.selectUnit=function(n){(n.Current||n.Start!==null&&n.End!==null)&&(o.selectedUnit(n.Id),o.start(moment(n.Start).format("YYYY-MM-DD")),o.end(moment(n.End).format("YYYY-MM-DD")))};o.selectPeriod=function(){updateSelectedPeriodPreset(o.start,o.end,o.selectedPeriod)};o.selectOther=function(n){selectOtherPeriodPreset(o.periods,o.selectedPeriod,n)};o.startFormatted=ko.pureComputed(function(){return moment(o.start()).format("YYYY-MM-DD")});o.endFormatted=ko.pureComputed(function(){return moment(o.end()).format("YYYY-MM-DD")});o.loadOverviewTrigger=ko.computed(function(){if(ko.computedContext.isInitial()){n.selectedSubscription();return}o.loadOverview()}).extend({referred:!0});o.loadOverview=function(t){o.loadingOverview(!0);var f=i.overview();t&&(f+="/"+t);$.get(f,function(t){o.premiumProgress(t.PremiumProgress);o.essentialsProgress(t.EssentialsProgress);o.subscriptions(t.Subscriptions);r?n.selectedSubscription(t.Subscription.SubscriptionId):(n.goal(t.GoalProgress),n.selectedClass=t.Subscription.Class.ClassId,n.class(t.Subscription.Class),n.user(t.User),n.selectedSubscription(t.Subscription.Subscription.SubscriptionId),n.alerts(t.GroupedAlerts.DataSet[0]!==undefined?t.GroupedAlerts.DataSet[0].Alerts.map(function(n){return{alert:ko.observable(n)}}):[]));o.selectedLevel(t.PremiumProgress===null?t.EssentialsProgress.LevelId:t.PremiumProgress.LevelId);o.selectedUnit(t.PremiumProgress===null?null:t.PremiumProgress.UnitId);o.scoreClassification.medium=u.ScoreMediumClassification;o.scoreClassification.high=u.ScoreHighClassification}).always(function(){o.loadingOverview(!1)})};o.loadScorecardTrigger=ko.computed(function(){if(ko.computedContext.isInitial()){n.selectedSubscription();o.startFormatted();o.endFormatted();return}o.loadScorecard()}).extend({deferred:!0});o.loadScorecard=function(){o.startFormatted()&&o.endFormatted()&&(o.loadingScorecard(!0),$.get(i.scorecard(o),function(n){var i,t,r;for(o.scorecard(n.scorecard),o.progressGraph.init(n.exams,$(".progress-overview-graph")),i=[],t=0;t<n.exercises.length;t++)i.push(getScoreColor(n.exercises[t].ScoreClassification));r=[{data:n.exercises,label:"Time",fill:"origin",backgroundColor:i}];n.units&&r.push({data:n.units.Weeks,label:"Unit",type:"line",yAxisID:"B",fill:!1,color:housestyle.holmwoodsBlue,valueProperty:"Position",yLabels:n.units.Units,hide:ko.observable(!o.unitProgressShown())});o.progressChart.progressChart.datasets(r)}).always(function(){o.loadingScorecard(!1)}))};o.progressGraph=new progressOverviewGraph(new studentProgressColorGetter(o.scoreClassification),0,1)}function studentWeeklyProgressGraphViewModel(n,t){var i=this;i.progressChartWidth=null;i.progressChart={type:"bar",showLegend:!1,maintainAspectRatio:!1,labelProperty:"Label",valueProperty:"Value",verticalGridLines:!1,horizontalGridLines:!1,highLightOnXPosition:!0,showXAxisLabels:!0,showYAxis:[!1,!1],offsetXAxis:!0,showTooltipTitle:!0,showTooltipColor:!1,tooltipsPosition:"nearest",getXAxisLabel:function(n,t){return i.progressChart.datasets().length>0&&i.progressChart.datasets()[0].data&&i.progressChart.datasets()[0].data.length>=t+1&&i.progressChart.datasets()[0].data[t].Week?i.progressChart.datasets()[0].data[t].Week.DisplayWeekNumber:""},getYAxisLabel:[null,function(n){return i.progressChart.datasets()[1].yLabels[n-1]}],getTooltipTitle:function(n,t){return t.labels[n[0].index]},getTooltipLabel:function(n){if(n.datasetIndex===0){var r=t.TimeLabel+": "+n.yLabel.toString()+" ";return r+(n.yLabel==1?t.Minute:t.Minutes)}return i.progressChart.datasets()[n.datasetIndex].yLabels[n.yLabel-1]},getTooltipBeforeBody:function(n,i){return t.ScoreLabel+": "+i.datasets[n[0].datasetIndex].meta[n[0].index].Score+" %"},tooltipBackgroundColor:housestyle.holmwoodsBlue,tooltipPadding:12,tooltipFontFamily:housestyle.defaultFontFamily,paddingLeft:40,paddingRight:40,datasets:ko.observableArray([]),onComplete:function(t){var r=t.chartArea.right-t.chartArea.left;if(i.progressChartWidth===null){i.progressChartWidth=r;return}n.unitProgressShown()?$(".progress-overview-graph").width(r/i.progressChartWidth*100+"%"):$(".progress-overview-graph").width("100%")}}}function studentProgressColorGetter(n){this.get=function(t){var u,i,r;if(Array.isArray(t)){for(u=0,i=0;i<t.length;i++)u+=t[i].item.Score;r=u/t.length}else r=t.Score;return r<n.medium?"red":r>=n.high?"green":"orange"}}function progressOverviewGraph(n,t,i){function e(t,i,r){var u=this;u.show=ko.observable(!1);u.left=ko.observable(t);u.width=s;u.midpoint=r;u.min=t;u.max=t;u.item=i;u.items=ko.observableArray([]);u.hideShow=function(){u.show(!u.show())};u.count=ko.pureComputed(function(){return Math.max(1,u.items().length)});u.color=ko.pureComputed(function(){return n.get(u.items().length>1?u.items():u.item)});u.css=ko.pureComputed(function(){return(u.count()>1?"group ":"individual ")+u.color()});u.pastMidpoint=ko.pureComputed(function(){return u.left()>u.midpoint})}var r=this,f=40,o=10,s=20+o,h=f+o,u=0;r.colorGetter=n;r.graphObjects=ko.observableArray([]);r.init=function(n,o){var h,c,s;for(r.length=o.width(),r.graphObjects([]),h=min=0,n.length>0&&(min=t===undefined?n[0].Position:t,h=i===undefined?n[n.length-1].Position:i),c=(r.length-f*2.5)/(h-min),s=0;s<n.length;s++)r.graphObjects.push(new e(f+c*(n[s].Position-min),n[s],r.length/2));u=0;r.combineItems();new ResizeSensor($(".progress-overview-graph"),function(n){for(var t,i,e,o=n.width,f=o/r.length,s=0;s<r.graphObjects().length;s++){for(t=r.graphObjects()[s],t.left(t.left()*f),i=0;i<t.items().length;i++)t.items()[i].left(t.items()[i].left()*f),t.items()[i].min=t.items()[i].min*f,t.items()[i].max=t.items()[i].max*f;t.min=t.min*f;t.max=t.max*f;t.midpoint=o/2}e=!1;u=0;f>1&&(e=r.separateItems());u=0;e=r.combineItems()||e;r.length=o})};r.combineItems=function(){var s=!0,i,n,t,f,o;for(u++,i=0;i<r.graphObjects().length;i++)if(n=r.graphObjects()[i],i<r.graphObjects().length-1&&r.graphObjects()[i+1].left()-n.left()<n.width){if(s=!1,t=r.graphObjects()[i+1],f=n.items(),f.length==0&&f.push(new e(n.left(),n.item,r.length)),t.items().length==0)f.push(new e(t.left(),t.item,r.length));else for(o=0;o<t.items().length;o++)f.push(t.items()[o]);n.items(f);n.left((n.left()+t.left())/2);n.width=h;n.min=Math.min(n.min,t.min);n.max=Math.max(n.max,t.max);r.graphObjects.remove(t)}return!s&&u<10?r.combineItems()||!0:!s};r.separateItems=function(){var f=!0,t,n,e,i;for(u++,t=0;t<r.graphObjects().length;t++)if(n=r.graphObjects()[t],n.count()>1&&(e=n.count()>2?50:30,n.max-n.min>e)){for(f=!1,r.graphObjects.remove(n),i=n.items().length-1;i>=0;i--)r.graphObjects.splice(t,0,n.items()[i]);t+=n.items().length-1}return!f&&u<10?r.separateItems()||!0:!f}}function StudentsPaymentViewModel(n){var t=this;t.provider=ko.observable();t.provider.subscribe(function(n){n==7?$("#provider_"+n).animate({height:95},250):$("#provider_7").animate({height:58},250)});t.paymentType=ko.observable();t.selectProvider=function(n,i){t.provider(n);t.paymentType(i)};$(document).on("click",".payment-provider",function(){var n=$(this).attr("id").substring(9);t.provider(n);t.paymentType($(this).data("payment-type"))});t.cancel=function(){n&&$.post("/api/sign-up/students/cancel/"+n,function(){window.location="/"})}}var hwd,resultTimelineViewModel;(function(n){n.fn.toJSON=function(t){t=n.extend({},t);var i=this,f={},r={},u={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(n,t,i){return n[t]=i,n},this.push_counter=function(n,t){return(r[n]===undefined&&(r[n]=0),t===undefined)?r[n]++:t!==undefined&&t>r[n]?r[n]=++t:void 0},n.each(n(this).serializeArray(),function(){if(u.validate.test(this.name)){for(var t,o=this.name.match(u.key),r=this.value,e=this.name;(t=o.pop())!==undefined;)e=e.replace(new RegExp("\\["+t+"\\]$"),""),t.match(u.push)?r=i.build([],i.push_counter(e),r):t.match(u.fixed)?(i.push_counter(e,t),r=i.build([],t,r)):t.match(u.named)&&(r=i.build({},t,r));f=n.extend(!0,f,r)}}),f}})(jQuery),function(n){typeof define=="function"&&define.amd?define(["jquery"],n):jQuery.sammy=window.Sammy=n(jQuery)}(function(n){var t,p="([^/]+)",s=/:([\w\d]+)/g,c=/\?([^#]*)?$/,r=function(n){return Array.prototype.slice.call(n)},i=function(n){return Object.prototype.toString.call(n)==="[object Function]"},u=function(n){return Object.prototype.toString.call(n)==="[object Array]"},l=function(n){return Object.prototype.toString.call(n)==="[object RegExp]"},e=function(n){return decodeURIComponent((n||"").replace(/\+/g," "))},a=encodeURIComponent,v=function(n){return String(n).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},f=function(n){return function(){return this.route.apply(this,[n].concat(Array.prototype.slice.call(arguments)))}},h={},o=!!(window.history&&history.pushState),y=[];return t=function(){var u=r(arguments),f,e;return(t.apps=t.apps||{},u.length===0||u[0]&&i(u[0]))?t.apply(t,["body"].concat(u)):typeof(e=u.shift())=="string"?(f=t.apps[e]||new t.Application,f.element_selector=e,u.length>0&&n.each(u,function(n,t){f.use(t)}),f.element_selector!=e&&delete t.apps[e],t.apps[f.element_selector]=f,f):void 0},t.VERSION="0.7.5",t.addLogger=function(n){y.push(n)},t.log=function(){var i=r(arguments);i.unshift("["+Date()+"]");n.each(y,function(n,r){r.apply(t,i)})},typeof console!="undefined"?typeof window.console.log=="function"&&i(window.console.log.apply)?t.addLogger(function(){window.console.log.apply(window.console,arguments)}):t.addLogger(function(){window.console.log(arguments)}):typeof console!="undefined"&&t.addLogger(function(){console.log.apply(console,arguments)}),n.extend(t,{makeArray:r,isFunction:i,isArray:u}),t.Object=function(t){return n.extend(this,t||{})},n.extend(t.Object.prototype,{escapeHTML:v,h:v,toHash:function(){var t={};return n.each(this,function(n,r){i(r)||(t[n]=r)}),t},toHTML:function(){var t="";return n.each(this,function(n,r){i(r)||(t+="<strong>"+n+"<\/strong> "+r+"<br />")}),t},keys:function(n){var t=[];for(var r in this)i(this[r])&&n||t.push(r);return t},has:function(t){return this[t]&&n.trim(this[t].toString())!==""},join:function(){var n=r(arguments),t=n.shift();return n.join(t)},log:function(){t.log.apply(t,arguments)},toString:function(t){var r=[];return n.each(this,function(n,u){(!i(u)||t)&&r.push('"'+n+'": '+u.toString())}),"Sammy.Object: {"+r.join(",")+"}"}}),t.targetIsThisWindow=function(t,i){var u=n(t.target).closest(i),r;return u.length===0?!0:(r=u.attr("target"),!r||r===window.name||r==="_self")?!0:r==="_blank"?!1:r==="top"&&window===window.top?!0:!1},t.DefaultLocationProxy=function(n,t){this.app=n;this.is_native=!1;this.has_history=o;this._startPolling(t)},t.DefaultLocationProxy.fullPath=function(n){var t=n.toString().match(/^[^#]*(#.+)$/),i=t?t[1]:"";return[n.pathname,n.search,i].join("")},n.extend(t.DefaultLocationProxy.prototype,{bind:function(){var u=this,r=this.app,i=t.DefaultLocationProxy;n(window).bind("hashchange."+this.app.eventNamespace(),function(n,t){u.is_native!==!1||t||(u.is_native=!0,window.clearInterval(i._interval),i._interval=null);r.trigger("location-changed")});o&&!r.disable_push_state&&(n(window).bind("popstate."+this.app.eventNamespace(),function(){r.trigger("location-changed")}),n(document).delegate("a","click.history-"+this.app.eventNamespace(),function(n){if(!n.isDefaultPrevented()&&!n.metaKey&&!n.ctrlKey){var f=i.fullPath(this),e=this.hostname?this.hostname:function(n){var t=document.createElement("a");return t.href=n.href,t.hostname}(this);if(e==window.location.hostname&&r.lookupRoute("get",f)&&t.targetIsThisWindow(n,"a"))return n.preventDefault(),u.setLocation(f),!1}}));i._bindings||(i._bindings=0);i._bindings++},unbind:function(){n(window).unbind("hashchange."+this.app.eventNamespace());n(window).unbind("popstate."+this.app.eventNamespace());n(document).undelegate("a","click.history-"+this.app.eventNamespace());t.DefaultLocationProxy._bindings--;t.DefaultLocationProxy._bindings<=0&&(window.clearInterval(t.DefaultLocationProxy._interval),t.DefaultLocationProxy._interval=null)},getLocation:function(){return t.DefaultLocationProxy.fullPath(window.location)},setLocation:function(n){if(/^([^#\/]|$)/.test(n)&&(n=o&&!this.app.disable_push_state?"/"+n:"#!/"+n),n!=this.getLocation())if(o&&!this.app.disable_push_state&&/^\//.test(n))history.pushState({path:n},window.title,n),this.app.trigger("location-changed");else return window.location=n},_startPolling:function(i){var u=this,r;t.DefaultLocationProxy._interval||(i||(i=10),r=function(){var i=u.getLocation();(typeof t.DefaultLocationProxy._last_location=="undefined"||i!=t.DefaultLocationProxy._last_location)&&window.setTimeout(function(){n(window).trigger("hashchange",[!0])},0);t.DefaultLocationProxy._last_location=i},r(),t.DefaultLocationProxy._interval=window.setInterval(r,i))}}),t.Application=function(n){var r=this;this.routes={};this.listeners=new t.Object({});this.arounds=[];this.befores=[];this.namespace=(new Date).getTime()+"-"+parseInt(Math.random()*1e3,10);this.context_prototype=function(){t.EventContext.apply(this,arguments)};this.context_prototype.prototype=new t.EventContext;i(n)&&n.apply(this,[this]);this._location_proxy||this.setLocationProxy(new t.DefaultLocationProxy(this,this.run_interval_every));this.debug&&this.bindToAllEvents(function(n,t){r.log(r.toString(),n.cleaned_type,t||{})})},t.Application.prototype=n.extend({},t.Object.prototype,{ROUTE_VERBS:["get","post","put","delete"],APP_EVENTS:["run","unload","lookup-route","run-route","route-found","event-context-before","event-context-after","changed","error","check-form-submission","redirect","location-changed"],_last_route:null,_location_proxy:null,_running:!1,element_selector:"body",debug:!1,raise_errors:!1,run_interval_every:50,disable_push_state:!1,template_engine:null,toString:function(){return"Sammy.Application:"+this.element_selector},$element:function(t){return t?n(this.element_selector).find(t):n(this.element_selector)},use:function(){var u=r(arguments),n=u.shift(),f=n||"";try{u.unshift(this);typeof n=="string"&&(f="Sammy."+n,n=t[n]);n.apply(this,u)}catch(e){typeof n=="undefined"?this.error("Plugin Error: called use() but plugin ("+f.toString()+") is not defined",e):i(n)?this.error("Plugin Error",e):this.error("Plugin Error: called use() but '"+f.toString()+"' is not a function",e)}return this},setLocationProxy:function(n){var t=this._location_proxy;this._location_proxy=n;this.isRunning()&&(t&&t.unbind(),this._location_proxy.bind())},log:function(){t.log.apply(t,Array.prototype.concat.apply([this.element_selector],arguments))},route:function(t,r){var f=this,o=[],e,h,u=Array.prototype.slice.call(arguments,2);if(u.length===0&&i(r)&&(u=[r],r=t,t="any"),t=t.toLowerCase(),r.constructor==String){for(s.lastIndex=0;(h=s.exec(r))!==null;)o.push(h[1]);r=new RegExp(r.replace(s,p)+"$")}return n.each(u,function(n,t){typeof t=="string"&&(u[n]=f[t])}),e=function(n){var t={verb:n,path:r,callback:u,param_names:o};f.routes[n]=f.routes[n]||[];f.routes[n].push(t)},t==="any"?n.each(this.ROUTE_VERBS,function(n,t){e(t)}):e(t),this},get:f("get"),post:f("post"),put:f("put"),del:f("delete"),any:f("any"),mapRoutes:function(t){var i=this;return n.each(t,function(n,t){i.route.apply(i,t)}),this},eventNamespace:function(){return["sammy-app",this.namespace].join("-")},bind:function(n,t,i){var r=this,u;return typeof i=="undefined"&&(i=t),u=function(){var t,u,n;t=arguments[0];n=arguments[1];n&&n.context?(u=n.context,delete n.context):u=new r.context_prototype(r,"bind",t.type,n,t.target);t.cleaned_type=t.type.replace(r.eventNamespace(),"");i.apply(u,[t,n])},this.listeners[n]||(this.listeners[n]=[]),this.listeners[n].push(u),this.isRunning()&&this._listen(n,u),this},trigger:function(n,t){return this.$element().trigger([n,this.eventNamespace()].join("."),[t]),this},refresh:function(){return this.last_location=null,this.trigger("location-changed"),this},before:function(n,t){return i(n)&&(t=n,n={}),this.befores.push([n,t]),this},after:function(n){return this.bind("event-context-after",n)},around:function(n){return this.arounds.push(n),this},onComplete:function(n){return this._onComplete=n,this},isRunning:function(){return this._running},helpers:function(t){return n.extend(this.context_prototype.prototype,t),this},helper:function(n,t){return this.context_prototype.prototype[n]=t,this},run:function(i){if(this.isRunning())return!1;var r=this;return n.each(this.listeners.toHash(),function(t,i){n.each(i,function(n,i){r._listen(t,i)})}),this.trigger("run",{start_url:i}),this._running=!0,this.last_location=null,/\#(.+)/.test(this.getLocation())||typeof i=="undefined"||this.setLocation(i),this._checkLocation(),this._location_proxy.bind(),this.bind("location-changed",function(){r._checkLocation()}),this.bind("submit",function(i){if(!t.targetIsThisWindow(i,"form"))return!0;var u=r._checkFormSubmission(n(i.target).closest("form"));return u===!1?i.preventDefault():!1}),n(window).bind("unload",function(){r.unload()}),this.trigger("changed")},unload:function(){if(!this.isRunning())return!1;var t=this;return this.trigger("unload"),this._location_proxy.unbind(),this.$element().unbind("submit").removeClass(t.eventNamespace()),n.each(this.listeners.toHash(),function(i,r){n.each(r,function(n,r){t._unlisten(i,r)})}),this._running=!1,this},destroy:function(){return this.unload(),delete t.apps[this.element_selector],this},bindToAllEvents:function(t){var i=this;return n.each(this.APP_EVENTS,function(n,r){i.bind(r,t)}),n.each(this.listeners.keys(!0),function(r,u){n.inArray(u,i.APP_EVENTS)==-1&&i.bind(u,t)}),this},routablePath:function(n){return n.replace(c,"")},lookupRoute:function(n,t){var e=this,u=!1,i=0,f,r;if(typeof this.routes[n]!="undefined")for(f=this.routes[n].length;i<f;i++)if(r=this.routes[n][i],e.routablePath(t).match(r.path)){u=r;break}return u},runRoute:function(t,i,r,u){var s=this,f=this.lookupRoute(t,i),o,c,y,l,a,h,v,p;if(this.debug&&this.log("runRoute",[t,i].join(" ")),this.trigger("run-route",{verb:t,path:i,params:r}),typeof r=="undefined"&&(r={}),n.extend(r,this._parseQueryString(i)),f){this.trigger("route-found",{route:f});(v=f.path.exec(this.routablePath(i)))!==null&&(v.shift(),n.each(v,function(n,t){f.param_names[n]?r[f.param_names[n]]=e(t):(r.splat||(r.splat=[]),r.splat.push(e(t)))}));o=new this.context_prototype(this,t,i,r,u);y=this.arounds.slice(0);l=this.befores.slice(0);h=[o];r.splat&&(h=h.concat(r.splat));c=function(){for(var n,t,i;l.length>0;)if(a=l.shift(),s.contextMatchesOptions(o,a[0])&&(n=a[1].apply(o,[o]),n===!1))return!1;return s.last_route=f,o.trigger("event-context-before",{context:o}),typeof f.callback=="function"&&(f.callback=[f.callback]),f.callback&&f.callback.length&&(t=-1,i=function(){t++;f.callback[t]?n=f.callback[t].apply(o,h):s._onComplete&&typeof(s._onComplete==="function")&&s._onComplete(o)},h.push(i),i()),o.trigger("event-context-after",{context:o}),n};n.each(y.reverse(),function(n,t){var i=c;c=function(){return t.apply(o,[i])}});try{p=c()}catch(w){this.error(["500 Error",t,i].join(" "),w)}return p}return this.notFound(t,i)},contextMatchesOptions:function(t,i,r){var f=i,h,e,a,v,c,o,s;if((typeof f=="string"||l(f))&&(f={path:f}),typeof r=="undefined"&&(r=!0),n.isEmptyObject(f))return!0;if(u(f.path)){for(h=[],e=0,v=f.path.length;e<v;e+=1)a=n.extend({},f,{path:f.path[e]}),h.push(this.contextMatchesOptions(t,a));return c=n.inArray(!0,h)>-1?!0:!1,r?c:!c}return f.only?this.contextMatchesOptions(t,f.only,!0):f.except?this.contextMatchesOptions(t,f.except,!1):(o=!0,s=!0,f.path&&(l(f.path)||(f.path=new RegExp(f.path.toString()+"$")),o=f.path.test(t.path)),f.verb&&(s=typeof f.verb=="string"?f.verb===t.verb:f.verb.indexOf(t.verb)>-1),r?s&&o:!(s&&o))},getLocation:function(){return this._location_proxy.getLocation()},setLocation:function(n){return this._location_proxy.setLocation(n)},swap:function(n,t){var r=this.$element().html(n);return i(t)&&t(n),r},templateCache:function(n,t){return typeof t!="undefined"?h[n]=t:h[n]},clearTemplateCache:function(){return h={}},notFound:function(n,t){var i=this.error(["404 Not Found",n,t].join(" "));return n==="get"?i:!0},error:function(n,t){if(t||(t=new Error),t.message=[n,t.message].join(" "),this.trigger("error",{message:t.message,error:t}),this.raise_errors)throw t;else this.log(t.message,t)},_checkLocation:function(){var n,t;return n=this.getLocation(),this.last_location&&this.last_location[0]=="get"&&this.last_location[1]==n||(this.last_location=["get",n],t=this.runRoute("get",n)),t},_getFormVerb:function(t){var u=n(t),i,r;return r=u.find('input[name="_method"]'),r.length>0&&(i=r.val()),i||(i=u[0].getAttribute("method")),i&&i!==""||(i="get"),n.trim(i.toString().toLowerCase())},_checkFormSubmission:function(t){var i,r,f,u,e;return this.trigger("check-form-submission",{form:t}),i=n(t),r=i.attr("action")||"",f=this._getFormVerb(i),this.debug&&this.log("_checkFormSubmission",i,r,f),f==="get"?(u=this._serializeFormParams(i),u!==""&&(r+="?"+u),this.setLocation(r),e=!1):(u=n.extend({},this._parseFormParams(i)),e=this.runRoute(f,r,u,t.get(0))),typeof e=="undefined"?!1:e},_serializeFormParams:function(n){var r="",t=n.serializeArray(),i;if(t.length>0)for(r=this._encodeFormPair(t[0].name,t[0].value),i=1;i<t.length;i++)r=r+"&"+this._encodeFormPair(t[i].name,t[i].value);return r},_encodeFormPair:function(n,t){return a(n)+"="+a(t)},_parseFormParams:function(n){for(var i={},r=n.serializeArray(),t=0;t<r.length;t++)i=this._parseParamPair(i,r[t].name,r[t].value);return i},_parseQueryString:function(n){var r={},t,u,f,i;if(t=n.match(c),t&&t[1])for(u=t[1].split("&"),i=0;i<u.length;i++)f=u[i].split("="),r=this._parseParamPair(r,e(f[0]),e(f[1]||""));return r},_parseParamPair:function(n,t,i){return typeof n[t]!="undefined"?u(n[t])?n[t].push(i):n[t]=[n[t],i]:n[t]=i,n},_listen:function(n,t){return this.$element().bind([n,this.eventNamespace()].join("."),t)},_unlisten:function(n,t){return this.$element().unbind([n,this.eventNamespace()].join("."),t)}}),t.RenderContext=function(n){this.event_context=n;this.callbacks=[];this.previous_content=null;this.content=null;this.next_engine=!1;this.waiting=!1},t.RenderContext.prototype=n.extend({},t.Object.prototype,{then:function(n){var r,t;if(!i(n))if(typeof n=="string"&&n in this.event_context)r=this.event_context[n],n=function(n){return r.apply(this.event_context,[n])};else return this;return t=this,this.waiting?this.callbacks.push(n):(this.wait(),window.setTimeout(function(){var i=n.apply(t,[t.content,t.previous_content]);i!==!1&&t.next(i)},0)),this},wait:function(){this.waiting=!0},next:function(n){this.waiting=!1;typeof n!="undefined"&&(this.previous_content=this.content,this.content=n);this.callbacks.length>0&&this.then(this.callbacks.shift())},load:function(t,r,u){var f=this;return this.then(function(){var e,s,o;return(i(r)?(u=r,r={}):r=n.extend({},r),u&&this.then(u),typeof t=="string")?(o=t.match(/\.json(\?|$)/)||r.json,e=o?r.cache===!0:r.cache!==!1,f.next_engine=f.event_context.engineFor(t),delete r.cache,delete r.json,r.engine&&(f.next_engine=r.engine,delete r.engine),e&&(s=this.event_context.app.templateCache(t)))?s:(this.wait(),n.ajax(n.extend({url:t,data:{},dataType:o?"json":"text",type:"get",success:function(n){e&&f.event_context.app.templateCache(t,n);f.next(n)}},r)),!1):t.nodeType?t.innerHTML:t.selector?(f.next_engine=t.attr("data-engine"),r.clone===!1?t.remove()[0].innerHTML.toString():t[0].innerHTML.toString()):void 0})},loadPartials:function(n){var t;if(n){this.partials=this.partials||{};for(t in n)(function(t,i){t.load(n[i]).then(function(n){this.partials[i]=n})})(this,t)}return this},render:function(n,t,r,u){return i(n)&&!t?this.then(n):(i(t)?(u=r,r=t,t=null):r&&!i(r)&&(u=r,r=null),this.loadPartials(u).load(n).interpolate(t,n).then(r))},partial:function(n,t,r,u){return i(r)?this.render(n,t,u).swap(r):i(t)?this.render(n,{},r).swap(t):this.render(n,t,r).swap()},send:function(){var t=this,n=r(arguments),i=n.shift();return u(n[0])&&(n=n[0]),this.then(function(){return n.push(function(n){t.next(n)}),t.wait(),i.apply(i,n),!1})},collect:function(t,r,u){var e=this,f=function(){i(t)&&(r=t,t=this.content);var u=[],f=!1;return n.each(t,function(n,t){var i=r.apply(e,[n,t]);return i.jquery&&i.length==1&&(i=i[0],f=!0),u.push(i),i}),f?u:u.join("")};return u?f():this.then(f)},renderEach:function(t,i,r,f){return u(i)&&(f=r,r=i,i=null),this.load(t).then(function(e){var o=this;if(r||(r=u(this.previous_content)?this.previous_content:[]),f)n.each(r,function(n,r){var u={},s=this.next_engine||t;i?u[i]=r:u=r;f(r,o.event_context.interpolate(e,u,s))});else return this.collect(r,function(n,r){var u={},f=this.next_engine||t;return i?u[i]=r:u=r,this.event_context.interpolate(e,u,f)},!0)})},interpolate:function(n,t,i){var r=this;return this.then(function(u,f){!n&&f&&(n=f);this.next_engine&&(t=this.next_engine,this.next_engine=!1);var e=r.event_context.interpolate(u,n,t,this.partials);return i?f+e:e})},swap:function(n){return this.then(function(t){return this.event_context.swap(t,n),t}).trigger("changed",{})},appendTo:function(t){return this.then(function(i){n(t).append(i)}).trigger("changed",{})},prependTo:function(t){return this.then(function(i){n(t).prepend(i)}).trigger("changed",{})},replace:function(t){return this.then(function(i){n(t).html(i)}).trigger("changed",{})},trigger:function(n,t){return this.then(function(i){return typeof t=="undefined"&&(t={content:i}),this.event_context.trigger(n,t),i})}}),t.EventContext=function(n,i,r,u,f){this.app=n;this.verb=i;this.path=r;this.params=new t.Object(u);this.target=f},t.EventContext.prototype=n.extend({},t.Object.prototype,{$element:function(){return this.app.$element(r(arguments).shift())},engineFor:function(n){var t=this,r;return i(n)?n:(n=(n||t.app.template_engine).toString(),(r=n.match(/\.([^\.\?\#]+)(\?|$)/))&&(n=r[1]),n&&i(t[n]))?t[n]:t.app.template_engine?this.engineFor(t.app.template_engine):function(n){return n}},interpolate:function(n,t,i,r){return this.engineFor(i).apply(this,[n,t,r])},render:function(n,i,r,u){return new t.RenderContext(this).render(n,i,r,u)},renderEach:function(n,i,r,u){return new t.RenderContext(this).renderEach(n,i,r,u)},load:function(n,i,r){return new t.RenderContext(this).load(n,i,r)},loadPartials:function(n){return new t.RenderContext(this).loadPartials(n)},partial:function(n,i,r,u){return new t.RenderContext(this).partial(n,i,r,u)},send:function(){var n=new t.RenderContext(this);return n.send.apply(n,arguments)},redirect:function(){var t,i=r(arguments),l=this.app.getLocation(),o=i.length,e;if(o>1){for(var u=0,s=[],h=[],f={},c=!1;u<o;u++)typeof i[u]=="string"?s.push(i[u]):(n.extend(f,i[u]),c=!0);if(t=s.join("/"),c){for(e in f)h.push(this.app._encodeFormPair(e,f[e]));t+="?"+h.join("&")}}else t=i[0];this.trigger("redirect",{to:t});this.app.last_location=[this.verb,this.path];this.app.setLocation(t);new RegExp(t).test(l)&&this.app.trigger("location-changed")},trigger:function(n,t){return typeof t=="undefined"&&(t={}),t.context||(t.context=this),this.app.trigger(n,t)},eventNamespace:function(){return this.app.eventNamespace()},swap:function(n,t){return this.app.swap(n,t)},notFound:function(){return this.app.notFound(this.verb,this.path)},json:function(t){return n.parseJSON(t)},toString:function(){return"Sammy.EventContext: "+[this.verb,this.path,this.params].join(" ")}}),t}),function(n,t){typeof define=="function"&&define.amd?define(["./ResizeSensor.js"],t):typeof exports=="object"?module.exports=t(require("./ResizeSensor.js")):(n.ElementQueries=t(n.ResizeSensor),n.ElementQueries.listen())}(typeof window!="undefined"?window:this,function(n){var t=function(){function e(n){n||(n=document.documentElement);var t=window.getComputedStyle(n,null).fontSize;return parseFloat(t)||16}function c(n){if(!n.getBoundingClientRect)return{width:n.offsetWidth,height:n.offsetHeight};var t=n.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function l(n,t){var i=t.split(/\d/),r=i[i.length-1];t=parseFloat(t);switch(r){case"px":return t;case"em":return t*e(n);case"rem":return t*e();case"vw":return t*document.documentElement.clientWidth/100;case"vh":return t*document.documentElement.clientHeight/100;case"vmin":case"vmax":var u=document.documentElement.clientWidth/100,f=document.documentElement.clientHeight/100,o=Math[r==="vmin"?"min":"max"];return t*o(u,f);default:return t}}function a(n,i){this.element=n;var s,r,h,a,v,u,f,o,e=["min-width","min-height","max-width","max-height"];this.call=function(){h=c(this.element);u={};for(s in t[i])t[i].hasOwnProperty(s)&&(r=t[i][s],a=l(this.element,r.value),v=r.property==="width"?h.width:h.height,o=r.mode+"-"+r.property,f="",r.mode==="min"&&v>=a&&(f+=r.value),r.mode==="max"&&v<=a&&(f+=r.value),u[o]||(u[o]=""),f&&-1===(" "+u[o]+" ").indexOf(" "+f+" ")&&(u[o]+=" "+f));for(var n in e)e.hasOwnProperty(n)&&(u[e[n]]?this.element.setAttribute(e[n],u[e[n]].substr(1)):this.element.removeAttribute(e[n]))}}function o(t,i){t.elementQueriesSetupInformation||(t.elementQueriesSetupInformation=new a(t,i));t.elementQueriesSensor||(t.elementQueriesSensor=new n(t,function(){t.elementQueriesSetupInformation.call()}))}function v(n,u,f,e){if(typeof t[n]=="undefined"){t[n]=[];var o=r.length;i.innerHTML+="\n"+n+" {animation: 0.1s element-queries;}";i.innerHTML+="\n"+n+" > .resize-sensor {min-width: "+o+"px;}";r.push(n)}t[n].push({mode:u,property:f,value:e})}function s(n){var t;if(document.querySelectorAll&&(t=n?n.querySelectorAll.bind(n):document.querySelectorAll.bind(document)),t||"undefined"==typeof $$||(t=$$),t||"undefined"==typeof jQuery||(t=jQuery),!t)throw"No document.querySelectorAll, jQuery or Mootools's $$ found.";return t}function y(n){var e=s(n),i,u,r,f;for(i in t)if(t.hasOwnProperty(i))for(u=e(i,n),r=0,f=u.length;r<f;r++)o(u[r],i)}function p(t){function a(){var n=!1,i,s;for(i in r)r.hasOwnProperty(i)&&e[i].minWidth&&t.offsetWidth>e[i].minWidth&&(n=i);n||(n=o);u!==n?h[n]?(r[u].style.display="none",r[n].style.display="block",u=n):(s=new Image,s.onload=function(){r[n].src=f[n];r[u].style.display="none";r[n].style.display="block";h[n]=!0;u=n},s.src=f[n]):r[n].src=f[n]}var r=[],e=[],f=[],o=0,u=-1,h=[],i,s,c,l;for(i in t.children)t.children.hasOwnProperty(i)&&t.children[i].tagName&&t.children[i].tagName.toLowerCase()==="img"&&(r.push(t.children[i]),s=t.children[i].getAttribute("min-width")||t.children[i].getAttribute("data-min-width"),c=t.children[i].getAttribute("data-src")||t.children[i].getAttribute("url"),f.push(c),l={minWidth:s},e.push(l),s?t.children[i].style.display="none":(o=r.length-1,t.children[i].style.display="block"));u=o;t.resizeSensorInstance=new n(t,a);a()}function w(){for(var i=s(),t=i("[data-responsive-image],[responsive-image]"),n=0,r=t.length;n<r;n++)p(t[n])}function u(n){var t,r,u,i;for(n=n.replace(/'/g,'"');null!==(t=b.exec(n));)for(r=t[1]+t[3],u=t[2];null!==(i=k.exec(u));)v(r,i[1],i[2],i[3])}function f(n){var i="",t,r;if(n)if("string"==typeof n)n=n.toLowerCase(),(-1!==n.indexOf("min-width")||-1!==n.indexOf("max-width"))&&u(n);else for(t=0,r=n.length;t<r;t++)1===n[t].type?(i=n[t].selectorText||n[t].cssText,-1!==i.indexOf("min-height")||-1!==i.indexOf("max-height")?u(i):(-1!==i.indexOf("min-width")||-1!==i.indexOf("max-width"))&&u(i)):4===n[t].type?f(n[t].cssRules||n[t].rules):3===n[t].type&&n[t].styleSheet.hasOwnProperty("cssRules")&&f(n[t].styleSheet.cssRules)}var i,t={},r=[],b=/,?[\s\t]*([^,\n]*?)((?:\[[\s\t]*?(?:min|max)-(?:width|height)[\s\t]*?[~$\^]?=[\s\t]*?"[^"]*?"[\s\t]*?])+)([^,\n\s\{]*)/mgi,k=/\[[\s\t]*?(min|max)-(width|height)[\s\t]*?[~$\^]?=[\s\t]*?"([^"]*?)"[\s\t]*?]/mgi,h=!1;this.init=function(){var u="animationstart",t,e;for(typeof document.documentElement.style.webkitAnimationName!="undefined"?u="webkitAnimationStart":typeof document.documentElement.style.MozAnimationName!="undefined"?u="mozanimationstart":typeof document.documentElement.style.OAnimationName!="undefined"&&(u="oanimationstart"),document.body.addEventListener(u,function(t){var i=t.target,f=i&&window.getComputedStyle(i,null),e=f&&f.getPropertyValue("animation-name"),h=e&&-1!==e.indexOf("element-queries"),s,u;h&&(i.elementQueriesSensor=new n(i,function(){i.elementQueriesSetupInformation&&i.elementQueriesSetupInformation.call()}),s=window.getComputedStyle(i.resizeSensor,null),u=s.getPropertyValue("min-width"),u=parseInt(u.replace("px","")),o(t.target,r[u]))}),h||(i=document.createElement("style"),i.type="text/css",i.innerHTML="[responsive-image] > img, [data-responsive-image] {overflow: hidden; padding: 0; } [responsive-image] > img, [data-responsive-image] > img {width: 100%;}",i.innerHTML+="\n@keyframes element-queries { 0% { visibility: inherit; } }",document.getElementsByTagName("head")[0].appendChild(i),h=!0),t=0,e=document.styleSheets.length;t<e;t++)try{document.styleSheets[t].href&&0===document.styleSheets[t].href.indexOf("file://")&&console.warn("CssElementQueries: unable to parse local css files, "+document.styleSheets[t].href);f(document.styleSheets[t].cssRules||document.styleSheets[t].rules||document.styleSheets[t].cssText)}catch(s){}w()};this.findElementQueriesElements=function(n){y(n)};this.update=function(){this.init()}},i;return t.update=function(){t.instance.update()},t.detach=function(n){n.elementQueriesSetupInformation?(n.elementQueriesSensor.detach(),delete n.elementQueriesSetupInformation,delete n.elementQueriesSensor):n.resizeSensorInstance&&(n.resizeSensorInstance.detach(),delete n.resizeSensorInstance)},t.init=function(){t.instance||(t.instance=new t);t.instance.init()},i=function(n){if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1);else if(/KHTML|WebKit|iCab/i.test(navigator.userAgent))var t=setInterval(function(){/loaded|complete/i.test(document.readyState)&&(n(),clearInterval(t))},10);else window.onload=n},t.findElementQueriesElements=function(n){t.instance.findElementQueriesElements(n)},t.listen=function(){i(t.init)},t}),function(n,t){typeof define=="function"&&define.amd?define(t):typeof exports=="object"?module.exports=t():n.ResizeSensor=t()}(typeof window!="undefined"?window:this,function(){function u(n,t){var i=Object.prototype.toString.call(n),u="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&n instanceof jQuery||"undefined"!=typeof Elements&&n instanceof Elements,r=0,f=n.length;if(u)for(;r<f;r++)t(n[r]);else t(n)}function f(n){if(!n.getBoundingClientRect)return{width:n.offsetWidth,height:n.offsetHeight};var t=n.getBoundingClientRect();return{width:Math.round(t.width),height:Math.round(t.height)}}function n(n,t){Object.keys(t).forEach(function(i){n.style[i]=t[i]})}var i,r,t,e;return typeof window=="undefined"?null:(i=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),r=i.requestAnimationFrame||i.mozRequestAnimationFrame||i.webkitRequestAnimationFrame||function(n){return i.setTimeout(n,20)},t=function(i,e){function o(){var t=[],n,i;this.add=function(n){t.push(n)};this.call=function(r){for(n=0,i=t.length;n<i;n++)t[n].call(this,r)};this.remove=function(r){var u=[];for(n=0,i=t.length;n<i;n++)t[n]!==r&&u.push(t[n]);t=u};this.length=function(){return t.length}}function s(t,i){var c,y,u,h,e,l,p,a;if(t){if(t.resizedAttached){t.resizedAttached.add(i);return}t.resizedAttached=new o;t.resizedAttached.add(i);t.resizeSensor=document.createElement("div");t.resizeSensor.dir="ltr";t.resizeSensor.className="resize-sensor";c={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"};y={position:"absolute",left:"0px",top:"0px",transition:"0s"};n(t.resizeSensor,c);u=document.createElement("div");u.className="resize-sensor-expand";n(u,c);h=document.createElement("div");n(h,y);u.appendChild(h);e=document.createElement("div");e.className="resize-sensor-shrink";n(e,c);l=document.createElement("div");n(l,y);n(l,{width:"200%",height:"200%"});e.appendChild(l);t.resizeSensor.appendChild(u);t.resizeSensor.appendChild(e);t.appendChild(t.resizeSensor);p=window.getComputedStyle(t);a=p?p.getPropertyValue("position"):null;"absolute"!==a&&"relative"!==a&&"fixed"!==a&&(t.style.position="relative");var w,b,s=f(t),d=0,g=0,nt=!0,k=0,rt=function(){var n=t.offsetWidth,i=t.offsetHeight;h.style.width=n+10+"px";h.style.height=i+10+"px";u.scrollLeft=n+10;u.scrollTop=i+10;e.scrollLeft=n+10;e.scrollTop=i+10},v=function(){if(nt){var n=t.offsetWidth===0&&t.offsetHeight===0;if(n){k||(k=r(function(){k=0;v()}));return}nt=!1}rt()};t.resizeSensor.resetSensor=v;var ut=function(){(b=0,w)&&(d=s.width,g=s.height,t.resizedAttached&&t.resizedAttached.call(s))},tt=function(){s=f(t);w=s.width!==d||s.height!==g;w&&!b&&(b=r(ut));v()},it=function(n,t,i){n.attachEvent?n.attachEvent("on"+t,i):n.addEventListener(t,i)};it(u,"scroll",tt);it(e,"scroll",tt);r(v)}}u(i,function(n){s(n,e)});this.detach=function(n){t.detach(i,n)};this.reset=function(){i.resizeSensor.resetSensor()}},t.reset=function(n){u(n,function(n){n.resizeSensor.resetSensor()})},t.detach=function(n,t){u(n,function(n){n&&(n.resizedAttached&&typeof t=="function"&&(n.resizedAttached.remove(t),n.resizedAttached.length())||n.resizeSensor&&(n.contains(n.resizeSensor)&&n.removeChild(n.resizeSensor),delete n.resizeSensor,delete n.resizedAttached))})},typeof MutationObserver!="undefined"&&(e=new MutationObserver(function(n){var u,r,i;for(u in n)if(n.hasOwnProperty(u))for(r=n[u].addedNodes,i=0;i<r.length;i++)r[i].resizeSensor&&t.reset(r[i])}),document.addEventListener("DOMContentLoaded",function(){e.observe(document.body,{childList:!0,subtree:!0})})),t)});!function(n){if("object"==typeof exports)module.exports=n();else if("function"==typeof define&&define.amd)define(n);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self);t.jsonpipe=n()}}(function(){return function n(t,i,r){function u(f,o){var h,s;if(!i[f]){if(!t[f]){if(h=typeof require=="function"&&require,!o&&h)return h(f,!0);if(e)return e(f,!0);throw new Error("Cannot find module '"+f+"'");}s=i[f]={exports:{}};t[f][0].call(s.exports,function(n){var i=t[f][1][n];return u(i?i:n)},s,s.exports,n,t,i,r)}return i[f].exports}for(var e=typeof require=="function"&&require,f=0;f<r.length;f++)u(r[f]);return u}({1:[function(n,t){"use strict";var i=n("./net/xhr"),r=n("./utils.js"),u=n("./parsers/json-chunk"),f=function(n,t){if(!n||(r.isString(n)||(t=n,n=t.url),!n||!t||!(t.success||t.error||t.complete)))return undefined;var f=new u(t);return t.onChunk=f.parse.bind(f),i.send(n,t)};t.exports={flow:f}},{"./net/xhr":2,"./parsers/json-chunk":3,"./utils.js":4}],2:[function(n,t){"use strict";function r(n){var u=n.split(/\r?\n/),e={},f,t,o,s,r,h;for(u.pop(),r=0,h=u.length;r<h;++r)t=u[r],f=t.indexOf(":"),o=t.slice(0,f).toLowerCase(),s=i(t.slice(f+1)),e[o]=s;return e}function u(n,t){var e;if(!n||!t)return undefined;var i=new XMLHttpRequest,o={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},u=function(){},c=(t.method||"").toUpperCase(),s=t.headers,l=t.onChunk||u,v=t.onHeaders||u,y=t.error||u,p=t.complete||u,a=c==="POST",f=!1,h;if(i.open(c||"GET",n,!0),i.onreadystatechange=function(){var n,t,u,e;i.readyState===o.HEADERS_RECEIVED?(n=i.getResponseHeader("Transfer-Encoding")||"",n=n.toLowerCase(),f=n.indexOf("chunked")>-1||n.indexOf("identity")>-1,f||(t=window.chrome,u=t&&t.loadTimes&&t.loadTimes(),e=u&&u.wasFetchedViaSpdy,f=!!(i.getResponseHeader("X-Firefox-Spdy")||e)),v(i.statusText,r(i.getAllResponseHeaders()))):i.readyState===o.LOADING?f&&i.responseText&&l(i.responseText):i.readyState===o.DONE&&(clearTimeout(h),i.status<200||i.status>299?y(i.statusText):l(i.responseText,!0),p(i.statusText))},s)for(e in s)i.setRequestHeader(e,s[e]),e.toLowerCase()==="content-type"&&(a=!1);return a&&i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.timeout&&(h=setTimeout(function(){i.abort();clearTimeout(h)},t.timeout)),i.withCredentials=t.hasOwnProperty("withCredentials")?t.withCredentials:!0,i.send(t.data),i}var i="".trim?function(n){return n.trim()}:function(n){return n.replace(/(^\s*|\s*$)/g,"")};t.exports={send:u}},{}],3:[function(n,t){"use strict";function r(n){this.offset=0;this.token=n.delimiter||"\n\n";this.success=n.success;this.error=n.error}var i=n("../utils.js");r.prototype.parse=function(n,t){var r=n.substring(this.offset),u=0,f=r.indexOf(this.token,u),e;for(f===0&&(u=this.token.length),f=r.indexOf(this.token,u);f>-1;)e=r.substring(u,f),e&&i.parse(e,this.success,this.error),u=f+this.token.length,f=r.indexOf(this.token,u);this.offset+=u;r=n.substring(this.offset);t&&r&&f===-1&&i.parse(r,this.success,this.error)};t.exports=r},{"../utils.js":4}],4:[function(n,t){"use strict";function r(n){return Object.prototype.toString.call(n)==="[object String]"}function i(n){return Object.prototype.toString.call(n)==="[object Function]"}function u(chunk){if(!chunk||!/^[\{|\[].*[\}|\]]$/.test(chunk))throw new Error("parseerror");return eval("("+chunk+")")}function f(n,t,r){var f;try{f=typeof JSON!="undefined"?JSON.parse(n):u(n)}catch(e){i(r)&&r("parsererror");return}f&&i(t)&&t(f)}t.exports={isString:r,isFunction:i,parse:f}},{}]},{},[1])(1)});!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(n=n||self).autocomplete=t()}(this,function(){"use strict";return function(n){function w(){c&&window.clearTimeout(c)}function s(){return!!t.parentNode}function o(){var n;l++;i=[];h="";u=void 0;(n=t.parentNode)&&n.removeChild(t)}function a(){for(var a,v,c,y,l;t.firstChild;)t.removeChild(t.firstChild);if(a=function(n){var t=f.createElement("div");return t.textContent=n.label||"",t},n.render&&(a=n.render),v=function(n){var t=f.createElement("div");return t.textContent=n,t},n.renderGroup&&(v=n.renderGroup),c=f.createDocumentFragment(),y="#9?$",i.forEach(function(t){var f,i;t.group&&t.group!==y&&(y=t.group,f=v(t.group,h),f&&(f.className+=" group",c.appendChild(f)));i=a(t,h);i&&(i.addEventListener("click",function(i){n.onSelect(t,r);o();i.preventDefault();i.stopPropagation()}),t===u&&(i.className+=" selected"),c.appendChild(i))}),t.appendChild(c),i.length<1){if(!n.emptyMsg)return void o();l=f.createElement("div");l.className="empty";l.textContent=n.emptyMsg;t.appendChild(l)}t.parentNode||f.body.appendChild(t),function(){function o(){var n=f.documentElement,s=n.clientTop||f.body.clientTop||0,h=n.clientLeft||f.body.clientLeft||0,c=window.pageYOffset||n.scrollTop,l=window.pageXOffset||n.scrollLeft,t=(i=r.getBoundingClientRect()).top+r.offsetHeight+c-s,o=i.left+l-h;e.top=t+"px";e.left=o+"px";(u=window.innerHeight-(i.top+r.offsetHeight))<0&&(u=0);e.top=t+"px";e.bottom="";e.left=o+"px";e.maxHeight=u+"px"}if(s()){e.height="auto";e.width=r.offsetWidth+"px";var i,u=0;o();o();n.customize&&i&&n.customize(r,i,t,u)}}(),function(){var f=t.getElementsByClassName("selected"),n,i,r,u;f.length>0&&(n=f[0],i=n.previousElementSibling,(i&&-1!==i.className.indexOf("group")&&!i.previousElementSibling&&(n=i),n.offsetTop<t.scrollTop)?t.scrollTop=n.offsetTop:(r=n.offsetTop+n.offsetHeight,u=t.scrollTop+t.offsetHeight,r>u&&(t.scrollTop+=r-u)))}()}function b(){s()&&a()}function k(){b()}function d(n){n.target!==t?b():n.preventDefault()}function g(n){for(var t=n.which||n.keyCode||0,i=0,r=[38,13,27,39,37,16,17,18,20,91,9];i<r.length;i++)if(t===r[i])return;t>=112&&t<=123||40===t&&s()||it(0)}function nt(t){var f=t.which||t.keyCode||0,e;if(38===f||40===f||27===f){if(e=s(),27===f)o();else{if(!s||i.length<1)return;38===f?function(){if(i.length<1)u=void 0;else if(u===i[0])u=i[i.length-1];else for(var n=i.length-1;n>0;n--)if(u===i[n]||1===n){u=i[n-1];break}}():function(){if(i.length<1&&(u=void 0),u&&u!==i[i.length-1]){for(var n=0;n<i.length-1;n++)if(u===i[n]){u=i[n+1];break}}else u=i[0]}();a()}return t.preventDefault(),void(e&&t.stopPropagation())}13===f&&(u&&(n.onSelect(u,r),o()),et&&t.preventDefault())}function tt(){ot&&it(1)}function it(t){var e=++l,f=r.value;f.length>=p||1===t?(w(),c=window.setTimeout(function(){n.fetch(f,function(n){l===e&&n&&(h=f,u=(i=n).length>0?i[0]:void 0,a())},0)},0===t?ft:0)):o()}function rt(){setTimeout(function(){f.activeElement!==r&&o()},200)}var u,c,f=document,t=f.createElement("div"),e=t.style,v=navigator.userAgent,ut=-1!==v.indexOf("Firefox")&&-1!==v.indexOf("Mobile"),ft=n.debounceWaitMs||0,et=n.preventSubmit||!1,y=ut?"input":"keyup",i=[],h="",p=2,ot=n.showOnFocus,l=0,r;if(void 0!==n.minLength&&(p=n.minLength),!n.input)throw new Error("input undefined");return r=n.input,t.className="autocomplete "+(n.className||""),e.position="absolute",t.addEventListener("mousedown",function(n){n.stopPropagation();n.preventDefault()}),t.addEventListener("focus",function(){return r.focus()}),r.addEventListener("keydown",nt),r.addEventListener(y,g),r.addEventListener("blur",rt),r.addEventListener("focus",tt),window.addEventListener("resize",k),f.addEventListener("scroll",d,!0),{destroy:function(){r.removeEventListener("focus",tt);r.removeEventListener("keydown",nt);r.removeEventListener(y,g);r.removeEventListener("blur",rt);window.removeEventListener("resize",k);f.removeEventListener("scroll",d,!0);w();o()}}}}),function(n){n.fn.overlay=function(t,i){var r={init:function(){var t,i;if(!this.is(":visible")){t=this;t.css({top:100,left:(n(window).innerWidth()-t.outerWidth())/2});t.addClass("overlay-open");i=n('<div class="overlay-wrapper"><\/div>');i.appendTo("body");t.appendTo("body");i.fadeIn(250,function(){t.show();t.find("form").length>0&&t.find("input:enabled:first").focus()});n(document).on("click",".cancel",function(n){r.close.call(t,n)});n(document).keyup(function(n){n.keyCode==27&&r.close.call(t,n)});this.data("settings").wrapper=i;return}},close:function(t){var f;if(this.is(":visible")){var r=n(this),u=n(".overlay-wrapper"),i=this.data("settings");i.secondaryOverlay===!0&&i.wrapper&&(u=i.wrapper);r.removeClass("overlay-open");r.fadeOut(200);u.fadeOut(200,function(){i.removeContent===!0&&r.remove();u.remove();i.partialViewModel===!0&&delete window.partialViewModel});i.resetForm!==!1&&this.find("form").each(function(){n(this)[0].reset()});f=t!==undefined&&(t.keyCode===27||n(event.target).attr("class")==="cancel");typeof i.close!="function"||f||i.close();typeof i.cancel=="function"&&f&&i.cancel();return}}};this.each(function(){var f={},u=n(this);if(f=typeof t=="object"?n.extend({},n.fn.overlay.defaults,t):typeof i=="object"?n.extend({},n.fn.overlay.defaults,i):n.fn.overlay.defaults,typeof u.data("settings")=="undefined"&&u.data({settings:f}),typeof t=="string"&&r[t])return r[t].apply(u);if(typeof t!="object"&&t)n.error("Method "+method+" does not exist on jQuery.overlay");else return r.init.apply(u)})};n.fn.overlay.defaults={close:function(){},partialViewModel:!1,removeContent:!1};n.extend({firstOrDefault:function(n,t){for(var i=0;i<n.length;i++)if(t(n[i],i))return n[i];return undefined}});n.validator&&(n.validator.addMethod("notequalto",function(t,i,r){var f,u,e;if(!this.optional(i))for(f=r.split(","),u=0;u<f.length;u++)if(e=n("#"+f[u]),e.val()==t)return!1;return!0}),n.validator.unobtrusive.adapters.addSingleVal("notequalto","otherproperty"));typeof n.ui.autocomplete!="undefined"&&n.widget("custom.autocompleteExtra",n.ui.autocomplete,{_renderItem:function(t,i){return i.extra||(i.extra=""),n("<li>").append(n("<div>").append(n("<a>").html(i.label+"<br><span>"+i.extra+"<\/span>"))).appendTo(t)}});n.ajaxPrefilter(function(t,i,r){var u=n('input[name="__RequestVerificationTokenApi"]').val();u&&r.setRequestHeader("X-XSRF-Token",u)})}(jQuery);hwd=new function(){var n=this;n.initialized=!1;n.format=function(n){var t=n.match(/\((.+?)\)\[(.+?)\]/g),i;if(t!=null&&t.length>0)for(i=0;i<t.length;i++){var r=t[i],u=r.match(/(\()(.+?)(?=\))/g)[0].replace("(",""),f=r.match(/(\[)(.+?)(?=\])/g)[0].replace("[",""),e='<span class="tt-suggestion" data-suggestion="'+f+'">'+u+"<\/span>";n=n.replace(r,e)}return n};n.tooltips=function(t){if(t=t||".tooltip",$(t).each(function(){var t=$(this).html();$(this).html(n.format(t))}),n.initialized===!1){$(document).on("mouseover","[data-suggestion]",function(n){var t=$(this).data("suggestion-position")||"top center",i=t=="top center"?"bottom center":"left center";$(this).qtip({content:{attr:"data-suggestion"},position:{at:t,my:i,viewport:!0},overwrite:!1,show:{event:n.type,ready:!0},style:{classes:"tt-qtip qtip-bootstrap"}},n)});n.initialized=!0}}};ko.bindingHandlers.audio={isFirstLoad:!0,update:function(n,t){var e={autoplay:!1,playOnFirstLoad:!0,src:"#"},r=t(),o="",u=!1,s=null,l=0;typeof r=="object"?($.extend(e,r),o=r.src):o=r;var i=$('<div class="player"><svg version="1.1" viewBox="0 0 58 58"><g transform="rotate(-90 28 28)"><circle id="bottom" cx="28" cy="28" r="28"/> <circle id="top" cx="28" cy="28" r="24" stroke-dasharray="150.80"/> <\/g> <g id="play"> <path d="M20.9,19.2l15.1,8.7l-15.1,8.7V19.2 M19.9,17.6v20.9l18.1-10.5L19.9,17.6L19.9,17.6z"/> <\/g> <g id="pause"> <path d="M25.5,18.5v19h-3v-19H25.5 M25.5,17.5h-3c-0.6,0-1,0.4-1,1v19c0,0.6,0.4,1,1,1h3c0.6,0,1-0.4,1-1v-19C26.5,17.9,26.1,17.5,25.5,17.5L25.5,17.5z"/><path d="M33.5,18.5v19h-3v-19H33.5 M33.5,17.5h-3c-0.6,0-1,0.4-1,1v19c0,0.6,0.4,1,1,1h3c0.6,0,1-0.4,1-1v-19C34.5,17.9,34.1,17.5,33.5,17.5L33.5,17.5z"/><\/g><\/svg><\/div>'),h={mediaError:function(n){i.find("svg").hide();i.append("Unfortunately, an error has occurred.");window.appInsights&&window.appInsights.trackException(new Error("Media Error"),"notused",{Type:n.target.error.code,Message:n.target.error.message,Target:n.target.src})},mediaPosition:function(n){var t=f.getDuration(),i=n/t*100;c(i)},mediaStatus:function(n){n==Media.MEDIA_STOPPED&&(i.removeClass("playing"),clearInterval(s),c(100),u=!1)}},f=new AudioPlayer(o,h.mediaError,h.mediaStatus),a=function(){l==100&&c(0);s=setInterval(function(){f.getPosition(h.mediaPosition)},50);f.play();i.addClass("playing");u=!0},c=function(n){var t=i.find("#top"),u=t.attr("r"),r;l=n;r=(100-n)/100*Math.PI*u*2;t.css("stroke-dashoffset",r)};$(n).append(i);$(n).on("click","svg",function(){console.log("Click received.");u===!0?(clearInterval(s),f.pause(),u=!1,$(n).find(".player").removeClass("playing")):a()});e.autoplay===!0&&(e.playOnFirstLoad||!ko.bindingHandlers.audio.isFirstLoad)&&a();ko.bindingHandlers.audio.isFirstLoad=!1},init:function(){}};ko.bindingHandlers.feed={update:function(n,t){var i=t();i!=null&&(i=i.replace("[b]","<strong>"),i=i.replace("[/b]","<\/strong>"),i=i.replace("[green]",'<span class="result-green">'),i=i.replace("[/green]","<\/span>"),i=i.replace("[red]",'<span class="result-red">'),i=i.replace("[/red]","<\/span>"),i=i.replace("[orange]",'<span class="result-orange">'),i=i.replace("[/orange]","<\/span>"),n.innerHTML=i)},init:function(){}};ko.bindingHandlers.valueWithInit={init:function(n,t,i,r){var u=t(),f=n.value;u(f);ko.bindingHandlers.value.init(n,t,i,r)},update:ko.bindingHandlers.value.update};ko.bindingHandlers.tooltip={update:function(n,t){var i=t();i!=null&&(n.innerHTML=hwd.format(i))},init:function(){}};ko.bindingHandlers.datepicker={init:function(n,t,i){var u=i().datepickerOptions||{},f=i().allowEmpty!==!1,r=$(n);r.datepicker(u);ko.utils.registerEventHandler(n,"change",function(){var n=r.datepicker("getDate"),i;(f||n!==null)&&(i=t(),i(n))});ko.utils.domNodeDisposal.addDisposeCallback(n,function(){r.datepicker("destroy")})},update:function(n,t){var i=ko.utils.unwrapObservable(t()),r=$(n),u=r.datepicker("getDate");i-u!=0&&r.datepicker("setDate",i)}};ko.bindingHandlers.timepicker={init:function(n,t,i){var u=i().timepickerOptions||{},r=$(n);r.timepicker(u);ko.utils.registerEventHandler(n,"change",function(){var n=t();n(r.timepicker("getTime"))});ko.utils.domNodeDisposal.addDisposeCallback(n,function(){r.timepicker("destroy")})},update:function(n,t){var i=ko.utils.unwrapObservable(t()),r=$(n),u=r.timepicker("getTime");i-u!=0&&r.timepicker("setTime",i)}};ko.bindingHandlers.weekpicker={init:function(n,t,i){var r=i().weekpickerOptions||{},h=$(n),u,f,e,o,s;n.readOnly=!0;e=r.beforeShow;r.beforeShow=function(n,t){$(t.dpDiv).addClass("ui-weekpicker");e&&e(n,t)};o=r.beforeShowDay;r.beforeShowDay=function(n){var t=[!0,"","Week "+n.getWeekNumber()],i;return n>=u&&n<=f&&(t[1]="ui-datepicker-current-day"),o&&(i=o(n),t[0]=i[0],t[1]+=" "+i[1],i[2]&&(t[2]+="\n"+i[2])),t};s=r.onSelect;r.onSelect=function(n,i){var e=new Date(n);u=new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay());f=new Date(e.getFullYear(),e.getMonth(),e.getDate()-e.getDay()+6);s&&s(n,i);r.displayDate==="start"?t()(u):r.displayDate==="end"&&t()(f)};r.onClose=function(){$(this).blur()};h.datepicker(r);$("body").on("mousemove",".ui-weekpicker .ui-datepicker-calendar tr",function(){$(this).find("td").addClass("ui-state-hover")});$("body").on("mouseleave",".ui-weekpicker .ui-datepicker-calendar tr",function(){$(this).find("td").removeClass("ui-state-hover")});ko.utils.domNodeDisposal.addDisposeCallback(n,function(){h.datepicker("destroy");$("body").off("mousemove",".ui-weekpicker .ui-datepicker-calendar tr");$("body").off("mouseleave",".ui-weekpicker .ui-datepicker-calendar tr")})},update:function(n,t){var i=ko.utils.unwrapObservable(t()),r=$(n),u=r.datepicker("getDate");i&&i-u!=0&&r.datepicker("setDate",i)}};ko.bindingHandlers.date={update:function(n,t){var r="",i=t(),u;i!=null&&(i.length>0&&(u=new Date(i),r=$.datepicker.formatDate("yy-mm-dd",u)),n.innerHTML=r)},init:function(){}};ko.bindingHandlers.datetime={update:function(n,t){var u="",i=t(),r;i!=null&&(i.length>0&&(i.slice(-1)!="Z"&&(i+="Z"),r=new Date(i),u=$.datepicker.formatDate("yy-mm-dd",r)+" "+r.toTimeString().substring(0,5)),n.innerHTML=u)},init:function(){}};ko.bindingHandlers.currency={init:function(n,t){var r,i=parseFloat(ko.utils.unwrapObservable(t()));i=="undefined"?i=0:r=parseFloat(i);n.innerHTML="&euro; "+r.toFixed(2)},update:function(n,t){var r,i=parseFloat(ko.utils.unwrapObservable(t()));i=="undefined"?i=0:r=parseFloat(i);n.innerHTML="&euro; "+r.toFixed(2)}};ko.bindingHandlers.ease={init:function(n,t,i,r){ko.utils.unwrapObservable(t())=="undefined"&&(n.innerHTML=0);ko.bindingHandlers.ease.update(n,t,i,r)},update:function(n,t){var i=parseInt(ko.utils.unwrapObservable(t())),r;if(i==undefined&&(i=0),i<1){n.innerHTML=i;return}r=new Tween(0,i,750,"easeOutQuint",function(t){n.innerHTML=Math.round(t)});r.start()}};ko.bindingHandlers.progress={init:function(n,t,i,r){ko.bindingHandlers.progress.update(n,t,i,r)},update:function(n,t){var r=parseFloat(ko.utils.unwrapObservable(t())),u,i;r=="undefined"&&(r=0);u=$(n);i=u.find("div");i.length<1&&(i=$("<div>").appendTo(u));i.animate({width:r.toFixed(1)+"%"},500)}};ko.bindingHandlers.score={init:function(n,t,i,r){ko.bindingHandlers.score.update(n,t,i,r)},update:function(n,t){var i=parseFloat(ko.utils.unwrapObservable(t()));i!=null&&$.isNumeric(i)===!0&&(i=="undefined"&&(i=0),n.innerHTML=i.toFixed(1))}};ko.bindingHandlers.time={update:function(n,t){var u=t(),i=Math.floor(u/60),r=Math.floor(u-i*60);i<10&&(i="0"+i);r<10&&(r="0"+r);n.innerHTML=i+":"+r}};ko.bindingHandlers.readonly={update:function(n,t){var i=ko.utils.unwrapObservable(t());i?n.setAttribute("readonly",!0):n.setAttribute("readonly",!1)}};ko.bindingHandlers.checkedListItem={after:["value","attr"],init:function(n,t,i){function o(){var l=$(n),h=!l.hasClass("selected"),f,i,o,c;(l.toggleClass("selected unselected"),f=u(),ko.computedContext.isInitial())||(i=t(),r?(o=s?i.peek():i,c=e,e=f,c!==f?h&&(ko.utils.addOrRemoveItem(o,f,!0),ko.utils.addOrRemoveItem(o,c,!1)):ko.utils.addOrRemoveItem(o,f,h),s&&ko.isWriteableObservable(i)&&i(o)):i(h))}function h(){var i=ko.utils.unwrapObservable(t()),f=u();r?(ko.utils.arrayIndexOf(i,f)>=0?$(n).addClass("selected").removeClass("unselected"):$(n).removeClass("selected").addClass("unselected"),e=f):f===undefined?i?$(n).addClass("selected").removeClass("unselected"):$(n).removeClass("selected").addClass("unselected"):u()===i?$(n).addClass("selected").removeClass("unselected"):$(n).removeClass("selected").addClass("unselected")}var u=ko.pureComputed(function(){return i.has("checkedValue")?ko.utils.unwrapObservable(i.get("checkedValue2")):c?i.has("value")?ko.utils.unwrapObservable(i.get("value")):n.value:void 0}),f=t(),r=ko.utils.unwrapObservable(f)instanceof Array,s=!(r&&f.push&&f.splice),c=r,e=r?u():undefined;ko.computed(o,null,{disposeWhenNodeIsRemoved:n});ko.utils.registerEventHandler(n,"click",o);ko.computed(h,null,{disposeWhenNodeIsRemoved:n});f=undefined}};ko.bindingHandlers.draggable={update:function(n){var t=$(n);t.draggable({revert:"invalid"});ko.utils.domNodeDisposal.addDisposeCallback(n,function(){t.draggable("destroy")})}};ko.bindingHandlers.droppable={update:function(n,t){var r=$(n),i=t();r.droppable({drop:function(n,t){$(this).removeClass("drop-over");i&&i.dropCallback&&i.dropCallback(this.dataset.id,t.helper[0].dataset.id)},over:function(){$(this).addClass("drop-over")},out:function(){$(this).removeClass("drop-over")}});ko.utils.domNodeDisposal.addDisposeCallback(n,function(){r.droppable("destroy")})}};ko.components.register("speak",{viewModel:function(n){var t=this;t.loading=ko.observable(!1);t.show=ko.observable(!0);t.playing=ko.observable(!1);t.interval=null;t.progress=ko.observable(0);t.source=ko.observable(undefined);t.values=ko.observableArray([]);t.currentIndex=null;t.showNextPrev=n.multipleSentences===!0;ko.isObservable(n.id)&&(t.idSubscription=n.id.subscribe(function(){t.source(undefined)}));t.getParam=function(n){return ko.isObservable(n)?n():n};t.source.subscribe(function(n){t.media.changeSrc(n)});t.getFile=function(i){t.loading()||(t.loading(!0),window.isiPad()&&(t.media.play(),t.media.pause()),$.post("/api/Activity/Speak/"+t.getParam(n.type),{id:t.getParam(n.id),exerciseId:t.getParam(n.exerciseId)},function(n){if(n===null){t.show(!1);return}n.Value?t.source("data:audio/mp3;base64,"+n.Value):(t.values(n.Values),t.currentIndex=-1,t.next());typeof i=="function"&&i()}).always(function(){t.loading(!1)}))};t.next=function(){t.currentIndex!==null&&(t.currentIndex++,t.currentIndex>=t.values().length&&(t.currentIndex=0),t.playSentence())};t.prev=function(){t.currentIndex!==null&&(t.currentIndex--,t.currentIndex<0&&(t.currentIndex=t.values().length-1),t.playSentence())};t.playSentence=function(){t.playing()&&t.play();t.source("data:audio/mp3;base64,"+t.values()[t.currentIndex]);t.play();$(".sentence").removeClass("playing");$("span#sentence-"+t.getParam(n.id)+"-"+t.currentIndex).addClass("playing")};t.events={mediaError:function(){t.show(!1)},mediaPosition:function(n){var i=t.media.getDuration(),r=n/i*100;t.progress(r)},mediaStatus:function(n){n===Media.MEDIA_STOPPED&&(clearInterval(t.interval),t.progress(100),t.playing(!1),$(".sentence").removeClass("playing"),t.values().length>0&&t.currentIndex+1<t.values().length&&t.next())}};t.media=new AudioPlayer(t.source(),t.events.mediaError,t.events.mediaStatus);window.isiPad()&&t.media.changeSrc("data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU2LjM2LjEwMAAAAAAAAAAAAAAA//OEAAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAEAAABIADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDV1dXV1dXV1dXV1dXV1dXV1dXV1dXV1dXV6urq6urq6urq6urq6urq6urq6urq6urq6v////////////////////////////////8AAAAATGF2YzU2LjQxAAAAAAAAAAAAAAAAJAAAAAAAAAAAASDs90hvAAAAAAAAAAAAAAAAAAAA//MUZAAAAAGkAAAAAAAAA0gAAAAATEFN//MUZAMAAAGkAAAAAAAAA0gAAAAARTMu//MUZAYAAAGkAAAAAAAAA0gAAAAAOTku//MUZAkAAAGkAAAAAAAAA0gAAAAANVVV");t.play=function(){t.playing()?(clearInterval(t.interval),t.media.pause(),t.playing(!1)):t.source()===undefined?t.getFile(t.startPlaying):(t.startPlaying(),t.values().length>0&&$("span#sentence-"+t.getParam(n.id)+"-"+t.currentIndex).addClass("playing"))};t.startPlaying=function(){t.progress()===100&&t.progress(0);t.interval=setInterval(function(){t.media.getPosition(t.events.mediaPosition)},50);t.media.play();t.playing(!0)};t.stroke=ko.pureComputed(function(){return(100-t.progress()/100)*Math.PI*48});t.dispose=function(){t.idSubscription&&t.idSubscription.dispose();t.interval&&clearInterval(t.interval);t.media&&(t.media.pause(),t.media.src="")}},template:'<!-- ko if: showNextPrev --><img src="/Images/Icons/Icon_player_prev.svg" data-bind="click: prev"><\/img><!-- /ko -->                <div class= "player speak" data-bind="click: play, clickBubble: false, if: show, css: { playing: playing }">                <svg version="1.1" viewBox="0 0 58 58">                    <g transform="rotate(-90 28 28)">                        <circle id="bottom" cx="28" cy="28" r="28"/>                        <circle id="top" cx="28" cy="28" r="24" stroke-dasharray="150.80" data-bind="style: { \'stroke-dashoffset\': stroke }"/>                    <\/g>                    <g id="play">                        <path d="M20.9,19.2l15.1,8.7l-15.1,8.7V19.2 M19.9,17.6v20.9l18.1-10.5L19.9,17.6L19.9,17.6z"/>                    <\/g>                    <g id="pause">                        <path d="M25.5,18.5v19h-3v-19H25.5 M25.5,17.5h-3c-0.6,0-1,0.4-1,1v19c0,0.6,0.4,1,1,1h3c0.6,0,1-0.4,1-1v-19C26.5,17.9,26.1,17.5,25.5,17.5L25.5,17.5z"/>                        <path d="M33.5,18.5v19h-3v-19H33.5 M33.5,17.5h-3c-0.6,0-1,0.4-1,1v19c0,0.6,0.4,1,1,1h3c0.6,0,1-0.4,1-1v-19C34.5,17.9,34.1,17.5,33.5,17.5L33.5,17.5z"/>                    <\/g>                <\/svg>                <\/div>                <!-- ko if: showNextPrev --><img src="/Images/Icons/Icon_player_next.svg" data-bind="click: next"><\/img><!-- /ko -->'});ko.pagedDataSet=function(n){var t=this;t.error=n.error||function(){console.log("The call failed!")};t.loading=n.loading||ko.observable();t.pageSize=ko.observable(n.pageSize||20);t.page=n.page||ko.observable(n.initialPage);t.pages=ko.observable();t.total=ko.observable();t.url=n.url;t.data=n.data||{};t.type=n.type||"GET";t.hideOtherPages=ko.observable(n.hideOtherPages||!1);t._callback=function(){};t.pageLinks=ko.computed(function(){var i,r,n;if(t.pages(),t.hideOtherPages())return[t.page()];for(i=[],r="...",n=1;n<=t.pages();n++)t.pages()<10||n<4||n>t.pages()-3||n<t.page()+3&&n>t.page()-3?i.push(n):i[i.length-1]!==r&&i.push(r);return i});t.hasPrev=ko.pureComputed(function(){return t.page(),!t.hideOtherPages()||t.page()>1});t.hasNext=ko.pureComputed(function(){return t.page(),t.pages(),!t.hideOtherPages()||t.page()<t.pages()});t.unwrap=function(i){t.pages(Math.ceil(i.Total/t.pageSize()));t.total(i.Total);n.pageCallback!=undefined&&n.pageCallback(t.pageLinks());n.dataCallback(i.DataSet);t.loading(!1)};t.page.subscribe(function(n){if($.isNumeric(n)){var i=(n-1)*t.pageSize();i<0&&(i=0);t.data.PageSize=t.pageSize();t.data.Start=i;t.load()}});t.pageSize.subscribe(function(){t.load()});t.reload=function(n){t._callback=n;t.page()!=1?t.page(1):t.load()};t.load=function(){t.data.PageSize=t.pageSize();t.loading(!0);$.ajax({data:ko.toJS(t.data),dataType:"json",type:t.type,url:t.url}).done(t.unwrap).fail(t.error).always(function(){typeof t._callback=="function"&&t._callback()})};t.setData=function(n){t.unwrap(n)};t.prev=function(){t.page()>1&&t.page(t.page()-1)};t.next=function(){t.page()<t.pages()&&t.page(t.page()+1)}};Array.prototype.remove=function(n,t){var i=this.slice((t||n)+1||this.length);return this.length=n<0?this.length+n:n,this.push.apply(this,i)};Date.prototype.getWeekNumber=function(){var n=new Date(Date.UTC(this.getFullYear(),this.getMonth(),this.getDate())),i=n.getUTCDay()||7,t;return n.setUTCDate(n.getUTCDate()+4-i),t=new Date(Date.UTC(n.getUTCFullYear(),0,1)),Math.ceil(((n-t)/864e5+1)/7)};window.isiPad=function(){return/ipad/i.test(navigator.userAgent)};window.isAndroidPhone=function(){return/Android/i.test(navigator.userAgent)&&/Mobile/i.test(navigator.userAgent)};window.isAndroidTablet=function(){return/Android/i.test(navigator.userAgent)&&!/Mobile/i.test(navigator.userAgent)};var viewModel,HolmwoodsViewModel=function(){var n=this,t,i;n.template=ko.observable();n.translations={};n.load=function(t,i){var r={bindViewModel:!0,complete:function(){},target:".main",url:""};if(typeof t=="string"?r.url=t:$.extend(r,t),n.template()!=r.url){var f=$(r.target),u=f.clone(!1),e=f.parent();u.children().remove();e.css("height",e.innerHeight()+"px");f.fadeOut(200,function(){$(this).after(u);$(this).remove();u.load(r.url,function(){n.template(r.url);r.bindViewModel===!0&&ko.applyBindings(viewModel,u[0]);e.css("height","auto");holmwoods.top();holmwoods.fixFooter();$('input[type="text"]:first').focus();u.find("form").length>0&&($form=u.find("form"),$form.removeData("validator"),$form.removeData("unobtrusiveValidation"),$.validator.unobtrusive.parse(r.target+" form"));typeof i=="function"&&i();typeof r.complete=="function"&&r.complete()})})}};n.analytics=function(){(function(n,t,i,r,u,f,e){n.GoogleAnalyticsObject=u;n[u]=n[u]||function(){(n[u].q=n[u].q||[]).push(arguments)};n[u].l=1*new Date;f=t.createElement(i);e=t.getElementsByTagName(i)[0];f.async=1;f.src=r;e.parentNode.insertBefore(f,e)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-5894436-16","auto");ga("set","forceSSL",!0);ga("set","anonymizeIp",!0);n.analyticsPage&&ga("set","page",n.analyticsPage);n.analyticsTitle&&ga("set","title",n.analyticsTitle);ga("send","pageview")};n.init=function(){window.disableAnalytics!==!0&&n.analytics();$(".progress-bar").each(function(){n.updateProgressBar($(this))});$(".menu-toggle").click(function(){$(this).hasClass("active")?($(this).removeClass("active"),$(".sidebar").addClass("hide")):($(this).addClass("active"),$(".sidebar").removeClass("hide"));$(".sidebar").toggle()});$(document).on("click","[data-href]",function(){var n=$(this).data("href");window.location=n});hwd.tooltips();n.toLocaleDate();n.fixFooter();n.initializeFeedback(".btn-help-problem");$(".i-signout a,.account .menu .signout a").on("click",function(){window.localStorage&&window.localStorage.setItem("logged_in",!1)});window.addEventListener("storage",n.storageChange,!1)};n.storageChange=function(n){n.key==="logged_in"&&n.newValue==="false"&&setTimeout(function(){window.location.reload()},500)};n.fixFooter=function(){var n=$("body").outerHeight(!1),t=$(window).innerHeight();n<t?$(".footer-container, .main-container, .sign-up-wrapper").addClass("fixed"):$(".footer-container, .main-container, .sign-up-wrapper").removeClass("fixed")};n.updateProgressBar=function(n){var i=n.find(".inner"),t=parseInt(n.attr("data-progress"));(i.length<1&&(i=$("<div>").addClass("inner").appendTo(n)),t<0)||(t>100&&(t=100),i.animate({width:t+"%"},500))};n._notificationTimeOut={};n.showNotification=function(t,i){n.dismissNotification(!0);var u=i===!0?"error":"success",f=i===!0?":(":":)",e=$('<div class="content notify '+u+' animated clearfix" />'),r=$(".hwd-notification").clone();r.find(".notify-icon").text(f);r.find(".notify-content").text(t);e.append(r).appendTo("body").show({effect:"highlight"});this._notificationTimeOut=setTimeout(function(){n.dismissNotification()},i?2e4:5e3)};n.dismissNotification=function(n){clearTimeout(this._notificationTimeOut);n?$(".notify").detach():$(".notify").fadeOut(250,function(){$(this).detach()})};n.showLoggedOutPopup=function(t){n.logInCallback=t;window.removeEventListener("storage",n.loggedInAgain);window.addEventListener("storage",n.loggedInAgain);$("#logged-out-overlay").overlay({partialViewModel:!1})};n.loggedInAgain=function(t){t.key==="logged_in_again"&&t.newValue==="true"&&($("#logged-out-overlay").overlay("close"),n.logInCallback&&n.logInCallback())};n.getLoader=function(){for(var n=$('<div class="loader white" />'),t=0;t<5;t++)n.append('<div class="circle" />');return n};n.getPropertyByPath=function(n,t,i){for(var r=0,t=t.split("."),u=t.length;r<u;r++){if(!n||typeof n!="object")return i;n=n[t[r]]}return n===undefined?i:n};n.toLocaleDate=function(n){$((n||"")+" [data-date-value]").each(function(){var n=$(this).data("date-value"),r="MM d, yy",u=$(this).data("date-format")||r,t="",i;switch(u){case"datetime":n.slice(-1)!="Z"&&(n+="Z");i=new Date(n);t=$.datepicker.formatDate(r,i)+" "+i.toTimeString().substring(0,5);break;default:t=$.datepicker.formatDate(u,new Date(n))}$(this).text(t)})};n.top=function(){$(window).scrollTop(0)};t=!1;i=!1;n.initializeFeedback=function(n){var u=$(n),r=".btn-screenshot-feedback-trigger";$(n).length>0&&t!==!0&&(t=!0,u.click(function(){return i!==!0?$.get("/Templates/Shared/_ScreenshotPopupPartial",{},function(n){i=!0;$("body").append(n);$(r).click()}):$(r).click(),!1}),$.feedback({ajaxURL:"/api/about/contact",html2canvasURL:"/Scripts/html2canvas.js",canvgURL:"/Scripts/canvg.js",RGBhelperURL:"/Scripts/rgbcolor.js",feedbackButton:r,ignoreHighlight:".background img",tpl:null,customFields:!0,useCORS:!0,postURL:!0}))}},holmwoods=new HolmwoodsViewModel,Tween=function(n,t,i,r,u){var f=this;f.interval=null;f.time=0;f.started=!1;f.reset=function(){f.stop();f.time=0};f.start=function(){f.started=!0;f.interval=setInterval(function(){var e;switch(r){case"easeInOutQuad":e=f.easeInOutQuad(f.time,n,t,i);break;case"easeOutQuad":e=f.easeOutQuad(f.time,n,t,i);break;case"easeOutQuint":e=f.easeOutQuint(f.time,n,t,i)}u(e);f.time+=20;f.time>=i&&clearInterval(f.interval)},20)};f.stop=function(){clearInterval(f.interval)};f.easeInOutQuad=function(n,t,i,r){return(n/=r/2)<1?i/2*n*n+t:-i/2*(--n*(n-2)-1)+t};f.easeOutQuad=function(n,t,i,r){return-i*(n/=r)*(n-2)+t};f.easeOutQuint=function(n,t,i,r){return i*(Math.pow(n/r-1,5)+1)+t}};$(function(){holmwoods.init();$(document).on("click",".language-link",function(){return $("div.language-menu").toggle(),!1});$(document).on("click",".language-menu li a",function(){var n=$(this).data("language-id");return $.post("/api/Language/Set",{LanguageId:n},function(){window.location.reload()}),!1});$(document).on("click",".notify",function(){holmwoods.dismissNotification()});$(document).on("click","ul.tabs li",function(){var t=$(this).index(),n=$(this).data("group");$(this).parent().children().removeClass("active");$(this).addClass("active");$(".tab-content > div").addClass("hidden");n!=undefined?$('.tab-content > div[data-group="'+n+'"]').removeClass("hidden"):$(".tab-content > div").eq(t).removeClass("hidden")});$(document).on("mouseenter","[data-tooltip]",function(){var n=$(this),r=n.attr("data-tooltip"),t=$('<div class="tooltip" />'),i=n.offset();t.html(r).css({left:i.left+n.width(),top:i.top});$("body").append(t)});$(document).on("mouseleave","[data-tooltip]",function(){$(".tooltip").detach()});$(document).on("click",".toggle",function(){var t=$(this).attr("data-toggle"),n;t!=null&&(n=$('[data-panel="'+t+'"]'),n.toggle(),$(this).removeClass("expanded"),n.is(":visible")&&$(this).addClass("expanded"))});$("form select, form input").first().focus()});var housestyle={holmwoodsBlue:"#3989E4",lightBlue:"rgba(57,137,228,0.65)",headerColor:"#334148",textColor:"#334148",backgroundGrey:"#EEEFF4",red:"#E5463A",orange:"#FCA73F",green:"#2FBD5C",defaultFontFamily:"'Open Sans', Sans-Serif, Helvetica, Verdana"},CourseType={ESSENTIALS:0,PREMIUM:1},PeriodType={OTHER:0},signalRStarted=!1,StartSignalR=function(){signalRStarted||$.connection.hub.start().done(function(){signalRStarted=!0})};$(function(){$(document).on("mouseenter",".account, .help",function(){$(this).children(".menu-container").removeClass("menu-hidden")});$(document).on("mouseleave",".account, .help",function(){$(this).children(".menu-container").addClass("menu-hidden")});$(document).on("change","input[id=sidebar]",function(){$.ajax({data:{Value:$("input[id=sidebar]").prop("checked"),Type:"ShowSideBar"},dataType:"json",type:"POST",url:"/api/teachers/usersetting"})})});var dashboardViewModel=function(n){var t=this;t.parent=new CommonViewModel(t);t.subscriptionId=ko.observable();t.course=ko.observable();t.selectCourse=function(n){t.subscriptionId(n)};t.subscriptionId.subscribe(function(n){$.get("/api/students/course/"+n,function(n){t.course(n.data)})});t.updateHistory=ko.computed(function(){var n="/Students/";return t.subscriptionId()&&(n+=t.subscriptionId()),window.history.replaceState(null,"",n),n}).extend({deferred:!0});t.init=function(){t.selectCourse(n);t.parent.init()}},overviewViewModel=function(n,t,i,r){var u=this;u.parent=new CommonViewModel(u);u.selectedSubscription=ko.observable(n.Subscription.SubscriptionId);u.courseType=ko.observable(n.Subscription.CourseType);u.viewModel=new studentOverviewViewModel(u,r,{unitHistory:function(n){return"/api/students/unithistory/"+u.selectedSubscription()+"/"+n.Id},overview:function(){return"/api/students/overview/"+u.selectedSubscription()},scorecard:function(n){return"/api/students/scorecard/"+u.selectedSubscription()+"/"+n.startFormatted()+"/"+n.endFormatted()}},!0,n,t,i);u.selectSubscription=function(n){u.selectedSubscription(n.SubscriptionId);u.courseType(n.CourseType);document.title=n.CurriculumDisplayName};u.updateHistory=ko.computed(function(){var n="/Students/Overview/"+u.selectedSubscription()+"/"+u.viewModel.startFormatted()+"/"+u.viewModel.endFormatted();return u.viewModel.selectedUnit()&&(n+="/"+u.viewModel.selectedUnit()),window.history.replaceState(null,"",n),n}).extend({deferred:!0});u.getPeriodPresets=ko.computed(function(){var n="/api/students/periodpresets/"+u.selectedSubscription();u.viewModel.loadingPeriod(!0);$.get(n,function(n){u.viewModel.periods(n.periods)}).always(function(){u.viewModel.loadingPeriod(!1)})});u.getResultUrl=function(n,t){var i="/Students/Results/"+u.selectedSubscription()+"/"+u.viewModel.startFormatted()+"/"+u.viewModel.endFormatted()+"/"+n;return t&&(i+="/"+t),i};u.init=function(){u.viewModel.loadOverview();u.viewModel.loadScorecard();u.parent.init()}},resultsViewModel=function(n,t,i,r,u,f,e,o,s){var h=this;h.parent=new CommonViewModel(h);h.subscriptions=t;h.results=new resultsTimelineViewModel(!1,n,t,null,i,r,u,f,e,o,s,"/api/students/groupedResults/");h.hasContent=ko.pureComputed(function(){return h.results.selectedSubscription().CourseType===CourseType.PREMIUM?h.results.premiumTimeline().length>0:h.results.essentialsTimeline().length>0});h.reload=ko.computed(function(){h.results.selectedSubscription();h.results.selectedView();h.results.selectedSkill();h.results.startDate(formatDate(h.results.startDate()));h.results.endDate(formatDate(h.results.endDate()));ko.ignoreDependencies(h.results.grid.reload,null)}).extend({deferred:!0});h.init=function(){h.parent.init()};h.updateHistory=ko.computed(function(){var n="/Students/Results/"+h.results.selectedSubscription().SubscriptionId+"/"+h.results.startDate()+"/"+h.results.endDate();return window.history.replaceState(null,"",n),n}).extend({deferred:!0});h.getPeriodPresets=ko.computed(function(){var n="/api/students/periodpresets/"+h.results.selectedSubscription().SubscriptionId;$.get(n,function(n){h.results.periods(n.periods)})}).extend({deferred:!0})},smartGoalDetailViewModel=function(n,t){var i=this;i.parent=new CommonViewModel(i);i.selectedSubscription=ko.observable(n.SubscriptionId);i.goal=new smartGoalViewModel(n,t);i.loadData=function(){i.goal.loadData("/api/SmartGoals/Student/"+i.selectedSubscription()+"/"+i.goal.filter(),function(){})};i.goal.filter.subscribe(i.loadData);i.updateHistory=ko.computed(function(){if(i.goal.selectedUser()){var n="/Students/SmartGoal/"+i.selectedSubscription();return window.history.replaceState(null,"",n),n}}).extend({deferred:!0});i.init=function(){i.loadData();i.parent.init()}},goalsViewModel=function(n){var t=this;t.parent=new CommonViewModel(t);t.goals=ko.observableArray([]);t.init=function(){$.get("/api/students/goals/"+n,function(n){for(var i=0;i<n.length;i++)n[i].Completed=n[i].Result.every(function(n){return n.Completed}),n[i].css=n[i].Completed?"completed":n[i].Goal.DaysLeft<5?"expiring":"";t.goals(n)});t.parent.init()}},signUpCodeViewModel=function(){var n=this;n.code=ko.observable();n.saving=ko.observable(!1);n.signUpCode=function(){n.code()&&(n.saving(!0),$.get("/api/sign-up/student/activate/"+n.code().trim(),function(n){n&&window.location.reload(!0)}).fail(function(n){holmwoods.showNotification(n.responseJSON,!0)}).always(function(){n.saving(!1)}))}};resultTimelineViewModel=function(n,t){var i=this;i.groupedResult=ko.observable(n);i.results=ko.observable();i.parent=t;i.showResult=ko.observable(!1);i.showResult.subscribe(function(n){if(n&&!i.results()){var t={subscriptionId:i.parent.selectedSubscription().SubscriptionId,userId:i.parent.selectedStudentId(),type:i.groupedResult().Type,selectedView:i.parent.selectedView(),selectedSkill:i.parent.selectedSkill()};i.parent.selectedSubscription().CourseType===CourseType.PREMIUM?(t.progressId=i.groupedResult().ProgressId,t.progressArchiveId=i.groupedResult().ProgressArchiveId,t.resitId=i.groupedResult().ResitId,t.startDate=i.parent.startDate(),t.endDate=i.parent.endDate()):(t.startDate=i.groupedResult().Week.Start,t.endDate=i.groupedResult().Week.End);$.get("/api/students/results/",t,function(n){i.results(n)})}});i.key=ko.pureComputed(function(){var n=i.groupedResult().Type+"_";return i.parent.selectedSubscription().CourseType===CourseType.PREMIUM?(n+=i.groupedResult().ProgressArchiveId?i.groupedResult().ProgressArchiveId:i.groupedResult().ProgressId,i.groupedResult().ResitId&&(n+="_"+i.groupedResult().ResitId)):n+=i.groupedResult().Week.Key,n})};var messagesViewModel=function(n){var t=this;t.parent=new CommonViewModel(t);t.loading=ko.observable(!1);t.saving=ko.observable(!1);t.pages=ko.observableArray([]);t.messages=ko.observableArray([]);t.viewReceived=ko.observable(!0);t.search=ko.observable("").extend({rateLimit:{method:"notifyWhenChangesStop",timeout:250}});t.grid=new ko.pagedDataSet({url:"/api/messages",data:{Filter:"",Received:t.viewReceived},dataCallback:function(n){t.messages(n)},pageCallback:t.pages,loading:t.loading,error:function(n){holmwoods.showNotification(n.responseJSON.Message,!0)}});t.init=function(){t.grid.reload();t.parent.init()};t.viewReceived.subscribe(function(){t.messages([]);t.grid.reload()});t.search.subscribe(function(n){t.grid.data.Filter=n;t.grid.reload()});t.open=function(t){window.location=(n?"/Teachers/Messages/View/":"/Students/Messages/View/")+t.MessageGroupId};t.send=function(){var n=createOverlay("");n.load("/Messages/New",function(){});n.overlay({partialViewModel:!0,removeContent:!0,close:function(){t.grid.load()}})}},viewMessageViewModel=function(n){var t=this;t.parent=new CommonViewModel(t);t.id=n;t.loading=ko.observable(!1);t.saving=ko.observable(!1);t.message=ko.observable(null);t.reply=ko.observable("");t.init=function(){t.loading(!0);t.reply("");$.get("/api/messages/view/"+t.id,t.message).always(function(){t.loading(!1)});t.parent.init()};t.send=function(){t.reply().length<1||(t.saving(!0),$.ajax({data:{MessageGroupId:n,Content:t.reply()},dataType:"json",type:"POST",url:"/api/Messages/Reply"}).done(function(n){n.Data&&n.Data!==t.id&&(window.history.replaceState(null,"",window.location.pathname.replace(t.id,n.Data)),t.id=n.Data);t.init()}).fail(function(n){holmwoods.showNotification(n.responseJSON.Message,!0)}).always(function(){t.saving(!1)}))}},sendMessageViewModel=function(n){var t=this;t.saving=ko.observable(!1);t.classes=ko.observableArray(n);t.selectedRecipients=ko.observableArray([]);t.subject=ko.observable("");t.content=ko.observable("");t.init=function(){autocomplete({input:document.getElementById("class-input"),className:"recipients-autocomplete",fetch:function(n,t){$.get("/api/Messages/Search?term="+n,t)},onSelect:function(n){var i=t.selectedRecipients().find(function(t){return n.id===t.id});return i===undefined&&t.selectedRecipients.push(n),this.input.value="",$(this).blur(),!1},debounceWaitMs:10,render:function(n){var t=document.createElement("div");return t.textContent=n.value,t},renderGroup:function(n){var t=document.createElement("div");return t.textContent=n,t}})};t.removeRecipient=function(n){var i=t.selectedRecipients().find(function(t){return n.id===t.id});i!==undefined&&t.selectedRecipients.remove(i)};t.submit=function(){if(t.selectedRecipients().length!==0){t.saving(!0);var n={Recipients:t.selectedRecipients().map(function(n){return n.id}),Subject:t.subject(),Content:t.content()};$.ajax({data:n,dataType:"json",type:"POST",url:"/api/Messages/Send"}).done(function(){$(".overlay").overlay("close")}).fail(function(n){holmwoods.showNotification(n.responseJSON.Message,!0)}).always(function(){t.saving(!1)})}};t.cancel=function(){$(".overlay").overlay("close")}};(function(n){n.feedback=function(t){function h(){var t=!0;return n.each(n("#feedback-textarea ol li input, #feedback-textarea ol li textarea"),function(n,i){if(!i.checkValidity())return t=!1,!1}),t}function f(){canDraw=!1;n(document).off("mouseenter mouseleave",".feedback-helper");n(document).off("mouseup keyup");n(document).off("mousedown",".feedback-setblackout");n(document).off("mousedown",".feedback-sethighlight");n(document).off("mousedown click","#feedback-close");n(document).off("mousedown","#feedback-canvas");n(document).off("click","#feedback-highlighter-next");n(document).off("click","#feedback-highlighter-back");n(document).off("click","#feedback-welcome-next");n(document).off("click","#feedback-overview-back");n(document).off("mouseleave","body");n(document).off("mouseenter",".feedback-helper");n(document).off("selectstart dragstart",document);n("#feedback-module").off("click",".feedback-wizard-close,.feedback-close-btn");n(document).off("click","#feedback-submit");i.highlightElement&&(n(document).off("click","#feedback-canvas"),n(document).off("mousemove","#feedback-canvas"));n('[data-highlighted="true"]').removeAttr("data-highlight-id").removeAttr("data-highlighted");i.tpl!=null?n("#feedback-module").remove():(n("#feedback-module").hide(),n("#feedback-overview").hide(),n("#feedback-submit-error").hide(),n("#feedback-submit-success").hide());n(".feedback-btn").show();i.onClose.call(this)}function r(t,i){i=typeof i!="undefined"?i:!0;t.clearRect(0,0,n("#feedback-canvas").width(),n("#feedback-canvas").height());t.fillStyle="rgba(102,102,102,0.5)";t.fillRect(0,0,n("#feedback-canvas").width(),n("#feedback-canvas").height());n(".feedback-helper").each(function(){n(this).attr("data-type")=="highlight"&&i&&u(t,parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height())});n(".feedback-helper").each(function(){n(this).attr("data-type")=="highlight"&&t.clearRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height())});n(".feedback-helper").each(function(){n(this).attr("data-type")=="blackout"&&(t.fillStyle="rgba(0,0,0,1)",t.fillRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height()))})}function u(n,t,r,u,f){n.strokeStyle=i.strokeStyle;n.shadowColor=i.shadowColor;n.shadowOffsetX=i.shadowOffsetX;n.shadowOffsetY=i.shadowOffsetY;n.shadowBlur=i.shadowBlur;n.lineJoin=i.lineJoin;n.lineWidth=i.lineWidth;n.strokeRect(t,r,u,f);n.shadowOffsetX=0;n.shadowOffsetY=0;n.shadowBlur=0;n.lineWidth=1}var i=n.extend({ajaxURL:"",postBrowserInfo:!0,postHTML:!0,postURL:!0,proxy:undefined,letterRendering:!1,initButtonText:"Send feedback",strokeStyle:"black",shadowColor:"black",shadowOffsetX:1,shadowOffsetY:1,shadowBlur:10,lineJoin:"bevel",lineWidth:3,html2canvasURL:"html2canvas.js",canvgURL:"canvg.js",RGBhelperURL:"rgbcolor.js",feedbackButton:".feedback-btn",showDescriptionModal:!0,isDraggable:!0,onScreenshotTaken:function(){},tpl:{description:'<div id="feedback-welcome"><div class="feedback-logo">Feedback<\/div><p>Feedback lets you send us suggestions about our products. We welcome problem reports, feature ideas and general comments.<\/p><p>Start by writing a brief description:<\/p><textarea id="feedback-note-tmp"><\/textarea><p>Next we\'ll let you identify areas of the page related to your description.<\/p><button id="feedback-welcome-next" class="feedback-next-btn feedback-btn-gray">Next<\/button><div id="feedback-welcome-error">Please enter a description.<\/div><div class="feedback-wizard-close"><\/div><\/div>',highlighter:'<div id="feedback-highlighter"><div class="feedback-logo">Feedback<\/div><p>Click and drag on the page to help us better understand your feedback. You can move this dialog if it\'s in the way.<\/p><button class="feedback-sethighlight feedback-active"><div class="ico"><\/div><span>Highlight<\/span><\/button><label>Highlight areas relevant to your feedback.<\/label><button class="feedback-setblackout"><div class="ico"><\/div><span>Black out<\/span><\/button><label class="lower">Black out any personal information.<\/label><div class="feedback-buttons"><button id="feedback-highlighter-next" class="feedback-next-btn feedback-btn-gray">Next<\/button><button id="feedback-highlighter-back" class="feedback-back-btn feedback-btn-gray">Back<\/button><\/div><div class="feedback-wizard-close"><\/div><\/div>',overview:'<div id="feedback-overview"><div class="feedback-logo">Feedback<\/div><div id="feedback-overview-description"><div id="feedback-overview-description-text"><h3>Description<\/h3><div class="feedback-info-box"><h3 class="feedback-additional">Additional info<\/h3><div id="feedback-additional-none"><span>None<\/span><\/div><div id="feedback-browser-info"><span>Browser Info<\/span><\/div><div id="feedback-page-info"><span>Page Info<\/span><\/div><div id="feedback-page-structure"><span>Page Structure<\/span><\/div><\/div><\/div><\/div><div id="feedback-overview-screenshot"><h3>Screenshot<\/h3><\/div><div class="feedback-buttons"><button id="feedback-submit" class="feedback-submit-btn feedback-btn-blue">Submit<\/button><button id="feedback-overview-back" class="feedback-back-btn feedback-btn-gray">Back<\/button><\/div><div id="feedback-overview-error">Please enter a description.<\/div><div class="feedback-wizard-close"><\/div><\/div>',submitSuccess:'<div id="feedback-submit-success"><div class="feedback-logo">Feedback<\/div><p>Thank you for your feedback. We value every piece of feedback we receive.<\/p><p>We cannot respond individually to every one, but we will use your comments as we strive to improve your experience.<\/p><button class="feedback-close-btn feedback-btn-blue">OK<\/button><div class="feedback-wizard-close"><\/div><\/div>',submitError:'<div id="feedback-submit-error"><div class="feedback-logo">Feedback<\/div><p>Sadly an error occured while sending your feedback. Please try again.<\/p><button class="feedback-close-btn feedback-btn-blue">OK<\/button><div class="feedback-wizard-close"><\/div><\/div>'},onClose:function(){},screenshotStroke:!0,highlightElement:!0,initialBox:!1,ignoreHighlight:null,showAdditionalInfoMessage:!1,requireDescription:!1,customFields:!1,useCORS:!1,data:null},t),s=!!window.HTMLCanvasElement,e=i.feedbackButton==".feedback-btn",o=!1;if(s){e&&n("body").append('<button class="feedback-btn feedback-btn-gray">'+i.initButtonText+"<\/button>");n(document).on("click",i.feedbackButton,function(){var t,y;e&&n(this).hide();o||(n.getScript(i.html2canvasURL,function(){o=!0}),n.getScript(i.canvgURL),n.getScript(i.RGBhelperURL));var s=!1,c="",w=n(document).height(),l=n(document).width(),v='<div id="feedback-module">';if(i.initialBox&&(v+=i.tpl.description),i.tpl==null?n("#feedback-module").show():(v+=i.tpl.highlighter+i.tpl.overview+'<canvas id="feedback-canvas"><\/canvas><div id="feedback-helpers"><\/div><input id="feedback-note" name="feedback-note" type="hidden"><\/div>',n("body").append(v)),moduleStyle={position:"absolute",left:"0px",top:"0px"},canvasAttr={width:l,height:w},n("#feedback-module").css(moduleStyle),n("#feedback-canvas").attr(canvasAttr).css("z-index","30000"),i.initialBox||(n("#feedback-highlighter-back").remove(),s=!0,n("#feedback-canvas").css("cursor","crosshair"),n("#feedback-helpers").show(),n("#feedback-welcome").hide(),n("#feedback-highlighter").show()),i.isDraggable)n("#feedback-highlighter").on("mousedown",function(t){var u=n(this).addClass("feedback-draggable"),i=u.outerHeight(),r=u.outerWidth(),f=u.offset().top+i-t.pageY,e=u.offset().left+r-t.pageX;u.css("z-index",4e4).parents().on("mousemove",function(t){_top=t.pageY+f-i;_left=t.pageX+e-r;_bottom=i-t.pageY;_right=r-t.pageX;_left<0&&(_left=0);_top<0&&(_top=0);_right>n(window).width()&&(_left=n(window).width()-r);_left>n(window).width()-r&&(_left=n(window).width()-r);_bottom>n(document).height()&&(_top=n(document).height()-i);_top>n(document).height()-i&&(_top=n(document).height()-i);n(".feedback-draggable").offset({top:_top,left:_left}).on("mouseup",function(){n(this).removeClass("feedback-draggable")})});t.preventDefault()}).on("mouseup",function(){n(this).removeClass("feedback-draggable");n(this).parents().off("mousemove mousedown")});if(t=n("#feedback-canvas")[0].getContext("2d"),t.fillStyle="rgba(102,102,102,0.5)",t.fillRect(0,0,n("#feedback-canvas").width(),n("#feedback-canvas").height()),rect={},drag=!1,highlight=1,post={},i.postBrowserInfo&&(post.browser={},post.browser.appCodeName=navigator.appCodeName,post.browser.appName=navigator.appName,post.browser.appVersion=navigator.appVersion,post.browser.cookieEnabled=navigator.cookieEnabled,post.browser.onLine=navigator.onLine,post.browser.platform=navigator.platform,post.browser.userAgent=navigator.userAgent,post.browser.plugins=[],n.each(navigator.plugins,function(n){post.browser.plugins.push(navigator.plugins[n].name)}),n("#feedback-browser-info").show()),i.postURL&&(post.url=document.URL,n("#feedback-page-info").show()),i.postHTML&&(post.html=n("html").html(),n("#feedback-page-structure").show()),i.data!=null)for(y in i.data)post[y]=i.data[y];i.showAdditionalInfoMessage||n(".feedback-info-box").hide();i.postBrowserInfo||i.postURL||i.postHTML||n("#feedback-additional-none").show();n(document).on("mousedown","#feedback-canvas",function(t){s&&(rect.startX=t.pageX-n(this).offset().left,rect.startY=t.pageY-n(this).offset().top,rect.w=0,rect.h=0,drag=!0)});n(document).on("mouseup",function(){if(s){drag=!1;var f=rect.startY,e=rect.startX,i=rect.w,u=rect.h;if(dtype="highlight",i==0||u==0)return;i<0&&(e+=i,i*=-1);u<0&&(f+=u,u*=-1);f+u>n(document).height()&&(u=n(document).height()-f);e+i>n(document).width()&&(i=n(document).width()-e);highlight==0&&(dtype="blackout");n("#feedback-helpers").append('<div class="feedback-helper" data-type="'+dtype+'" data-time="'+Date.now()+'" style="position:absolute;top:'+f+"px;left:"+e+"px;width:"+i+"px;height:"+u+'px;z-index:30000;"><\/div>');r(t);rect.w=0}});n(document).on("mousemove",function(i){s&&drag&&(n("#feedback-highlighter").css("cursor","default"),rect.w=i.pageX-n("#feedback-canvas").offset().left-rect.startX,rect.h=i.pageY-n("#feedback-canvas").offset().top-rect.startY,t.clearRect(0,0,n("#feedback-canvas").width(),n("#feedback-canvas").height()),t.fillStyle="rgba(102,102,102,0.5)",t.fillRect(0,0,n("#feedback-canvas").width(),n("#feedback-canvas").height()),n(".feedback-helper").each(function(){n(this).attr("data-type")=="highlight"&&u(t,parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height())}),highlight==1&&(u(t,rect.startX,rect.startY,rect.w,rect.h),t.clearRect(rect.startX,rect.startY,rect.w,rect.h)),n(".feedback-helper").each(function(){n(this).attr("data-type")=="highlight"&&t.clearRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height())}),n(".feedback-helper").each(function(){n(this).attr("data-type")=="blackout"&&(t.fillStyle="rgba(0,0,0,1)",t.fillRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height()))}),highlight==0&&(t.fillStyle="rgba(0,0,0,0.5)",t.fillRect(rect.startX,rect.startY,rect.w,rect.h)))});if(i.highlightElement){var b=[],a=[],p=0;n(document).on("mousemove click","#feedback-canvas",function(f){var e;if(s&&(r(t),a=[],n("#feedback-canvas").css("cursor","crosshair"),n("* :not(body,script,div,section,.feedback-btn,#feedback-module *)").not(i.ignoreHighlight).each(function(){n(this).attr("data-highlighted")!=="true"&&f.pageX>n(this).offset().left&&f.pageX<n(this).offset().left+n(this).width()&&f.pageY>n(this).offset().top+parseInt(n(this).css("padding-top"),10)&&f.pageY<n(this).offset().top+n(this).height()+parseInt(n(this).css("padding-top"),10)&&a.push(n(this))}),e=a[a.length-1],e&&!drag)){n("#feedback-canvas").css("cursor","pointer");var o=e.offset().left-2,h=e.offset().top-2,c=e.width()+parseInt(e.css("padding-left"),10)+parseInt(e.css("padding-right"),10)+6,l=e.height()+parseInt(e.css("padding-top"),10)+parseInt(e.css("padding-bottom"),10)+6;highlight==1&&(u(t,o,h,c,l),t.clearRect(o,h,c,l),dtype="highlight");n(".feedback-helper").each(function(){n(this).attr("data-type")=="highlight"&&t.clearRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height())});highlight==0&&(dtype="blackout",t.fillStyle="rgba(0,0,0,0.5)",t.fillRect(o,h,c,l));n(".feedback-helper").each(function(){n(this).attr("data-type")=="blackout"&&(t.fillStyle="rgba(0,0,0,1)",t.fillRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height()))});f.type=="click"&&f.pageX==rect.startX&&f.pageY==rect.startY&&(n("#feedback-helpers").append('<div class="feedback-helper" data-highlight-id="'+p+'" data-type="'+dtype+'" data-time="'+Date.now()+'" style="position:absolute;top:'+h+"px;left:"+o+"px;width:"+c+"px;height:"+l+'px;z-index:30000;"><\/div>'),b.push(p),++p,r(t))}})}n(document).on("mouseleave","body,#feedback-canvas",function(){r(t)});n(document).on("mouseenter",".feedback-helper",function(){r(t)});n(document).on("click","#feedback-welcome-next",function(){n("#feedback-note").val().length>0||!i.requireDescription?(s=!0,n("#feedback-canvas").css("cursor","crosshair"),n("#feedback-helpers").show(),n("#feedback-welcome").hide(),n("#feedback-highlighter").show()):n("#feedback-welcome-error").show()});n(document).on("mouseenter mouseleave",".feedback-helper",function(i){drag||(rect.w=0,rect.h=0,i.type==="mouseenter"?(n(this).css("z-index","30001"),n(this).append('<div class="feedback-helper-inner" style="width:'+(n(this).width()-2)+"px;height:"+(n(this).height()-2)+'px;position:absolute;margin:1px;"><\/div>'),n(this).append('<div id="feedback-close"><\/div>'),n(this).find("#feedback-close").css({top:n(this).find("#feedback-close").height()/-2+"px",left:n(this).width()-n(this).find("#feedback-close").width()/2+"px"}),n(this).attr("data-type")=="blackout"&&(t.clearRect(0,0,n("#feedback-canvas").width(),n("#feedback-canvas").height()),t.fillStyle="rgba(102,102,102,0.5)",t.fillRect(0,0,n("#feedback-canvas").width(),n("#feedback-canvas").height()),n(".feedback-helper").each(function(){n(this).attr("data-type")=="highlight"&&u(t,parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height())}),n(".feedback-helper").each(function(){n(this).attr("data-type")=="highlight"&&t.clearRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height())}),t.clearRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height()),t.fillStyle="rgba(0,0,0,0.75)",t.fillRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height()),ignore=n(this).attr("data-time"),n(".feedback-helper").each(function(){if(n(this).attr("data-time")==ignore)return!0;n(this).attr("data-type")=="blackout"&&(t.fillStyle="rgba(0,0,0,1)",t.fillRect(parseInt(n(this).css("left"),10),parseInt(n(this).css("top"),10),n(this).width(),n(this).height()))}))):(n(this).css("z-index","30000"),n(this).children().remove(),n(this).attr("data-type")=="blackout"&&r(t)))});n(document).on("click","#feedback-close",function(){if(i.highlightElement&&n(this).parent().attr("data-highlight-id"))var u=n(this).parent().attr("data-highlight-id");n(this).parent().remove();i.highlightElement&&u&&n('[data-highlight-id="'+u+'"]').removeAttr("data-highlighted").removeAttr("data-highlight-id");r(t)});n("#feedback-module").on("click",".feedback-wizard-close,.feedback-close-btn",function(){f()});n(document).on("keyup",function(n){n.keyCode==27&&f()});n(document).on("selectstart dragstart",document,function(n){n.preventDefault()});n(document).on("click","#feedback-highlighter-back",function(){s=!1;n("#feedback-canvas").css("cursor","default");n("#feedback-helpers").hide();n("#feedback-highlighter").hide();n("#feedback-welcome-error").hide();n("#feedback-welcome").show()});n(document).on("mousedown",".feedback-sethighlight",function(){highlight=1;n(this).addClass("feedback-active");n(".feedback-setblackout").removeClass("feedback-active")});n(document).on("mousedown",".feedback-setblackout",function(){highlight=0;n(this).addClass("feedback-active");n(".feedback-sethighlight").removeClass("feedback-active")});n(document).on("click","#feedback-highlighter-next",function(){s=!1;n("#feedback-canvas").css("cursor","default");var e=n(document).scrollTop(),u=n(window).height();n("#feedback-helpers").hide();n("#feedback-highlighter").hide();i.screenshotStroke||r(t,!1);html2canvas(document.body,{useCORS:i.useCORS,onrendered:function(o){i.screenshotStroke||r(t);_canvas=n('<canvas id="feedback-canvas-tmp" width="'+l+'" height="'+u+'"/>').hide().appendTo("body");_ctx=_canvas.get(0).getContext("2d");_ctx.drawImage(o,0,e,l,u,0,0,l,u);c=_canvas.get(0).toDataURL();n(document).scrollTop(e);post.img=c;i.onScreenshotTaken(post.img);i.showDescriptionModal?(n("#feedback-canvas-tmp").remove(),n("#feedback-overview").show(),i.customFields&&n("#feedback-textarea").show(),n("#feedback-overview-screenshot>img").remove(),n("#feedback-overview-screenshot").append('<img class="feedback-screenshot" src="'+c+'" />')):(n("#feedback-module").remove(),f(),_canvas.remove())},proxy:i.proxy,letterRendering:i.letterRendering})});n(document).on("click","#feedback-overview-back",function(){s=!0;n("#feedback-canvas").css("cursor","crosshair");n("#feedback-overview").hide();n("#feedback-helpers").show();n("#feedback-highlighter").show();n("#feedback-overview-error").hide()});if(!i.customFields)n(document).on("keyup","#feedback-note-tmp,#feedback-overview-note",function(t){var i;t.target.id==="feedback-note-tmp"?i=n("#feedback-note-tmp").val():(i=n("#feedback-overview-note").val(),n("#feedback-note-tmp").val(i));n("#feedback-note").val(i)});n(document).on("click","#feedback-submit",function(){if(s=!1,i.customFields&&h()||!i.customFields&&("#feedback-note".val().length>0||!i.requireDescription)){i.tpl!=null?n("#feedback-submit-success,#feedback-submit-error").remove():n("#feedback-submit-success,#feedback-submit-error").hide();n("#feedback-overview").hide();post.img=c;i.customFields||(post.note=n("#feedback-note").val());var t={screenshot:post};i.customFields&&n.each(n("#feedback-textarea ol li input, #feedback-textarea ol li textarea"),function(){t[this.name]=n(this).val()});n.ajax({url:i.ajaxURL,type:"POST",data:t,success:function(){i.tpl!=null?n("#feedback-module").append(i.tpl.submitSuccess):n("#feedback-submit-success").show()},error:function(){i.tpl!=null?n("#feedback-module").append(i.tpl.submitError):n("#feedback-submit-error").show()}})}else n("#feedback-overview-error").show()})})}}})(jQuery)